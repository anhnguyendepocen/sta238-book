<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Statistics and Plots | STA238: Probability, Statistics, and Data Analysis</title>
  <meta name="description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Statistics and Plots | STA238: Probability, Statistics, and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Statistics and Plots | STA238: Probability, Statistics, and Data Analysis" />
  
  <meta name="twitter:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

<meta name="author" content="Alison Gibbs and Alex Stringer" />


<meta name="date" content="2019-09-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="error.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA238 University of Toronto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Statistics and Plots</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.2</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i><b>1.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#extended-example-the-state-of-rental-housing-in-toronto"><i class="fa fa-check"></i><b>1.3</b> Extended example: the state of rental housing in Toronto</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistics-and-plots-1.html"><a href="statistics-and-plots-1.html"><i class="fa fa-check"></i><b>2</b> Statistics and Plots</a><ul>
<li class="chapter" data-level="2.1" data-path="statistics-and-plots-1.html"><a href="statistics-and-plots-1.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-and-plots-1.html"><a href="statistics-and-plots-1.html#extended-example-the-state-of-rental-housing-in-toronto-1"><i class="fa fa-check"></i><b>2.2</b> Extended example: the state of rental housing in Toronto</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="error.html"><a href="error.html"><i class="fa fa-check"></i><b>3</b> Error</a></li>
<li class="chapter" data-level="4" data-path="mathematical-models.html"><a href="mathematical-models.html"><i class="fa fa-check"></i><b>4</b> Mathematical Models</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA238: Probability, Statistics, and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics-and-plots-1" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Statistics and Plots</h1>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
<p>Data only becomes information after it is analyzed. Analyzing data is extraordinarily difficult,
but is the only way to learn meaningfully about the world.</p>
<p>In this book, you will learn about analyzing data. You will learn how to make principled,
measured statements about the data on hand (<em>descriptive statistics</em>); how to
use the data on hand to make statements about the underlying world, and how to
quantify the uncertainty in your statements (<em>inferential statistics</em>), and how
to use the data on hand to make judgements, with uncertainty quantification,
about what data you will see next (<em>predective statistics</em>).</p>
<p>This chapter focussed on <strong>descriptive statistics</strong>. This loosely refers to the set
of principles and tools that you use to tell a story using available data. The data
may be collected from a formal scientific experiment, or might be from a survey which
relies on a random sample of a population. It could exist already in a big database
at a bank or insurance company, or it could be scraped from the web. In all
cases, the sitation is: you have data, and you want to use it to <em>tell a story.</em></p>
<p>## Descriptive Statistics</p>
<p>Like with usual storytelling, how you <em>present</em> the data makes a big difference.
There is no one correct way to analyze any given dataset. You will make judgements,
and assumptions, and you will have to justify and explain them. These judgements
and assumptions can have a profound impact on the story you tell using your data.</p>
<p>For example, consider a famous dataset containing information on smoking and mortality.
The data is available in the <code>R</code> package <code>faraway</code>. We may load the package and data
and retrieve information on it as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages(&quot;faraway&quot;) # Run this to install the faraway package</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(faraway) <span class="co"># Attach the faraway package</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">data</span>(<span class="st">&quot;femsmoke&quot;</span>) <span class="co"># Load the &quot;femsmoke&quot; data</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># ?femsmoke # Run this to open the help page for the dataset.</span></a></code></pre></div>
<p>Lines in <code>R</code> that begin with a pound sign (or “hashtag” for the younger, more hip reader), <span class="math inline">\(\#\)</span>,
are comments and are not run. Remove the <span class="math inline">\(\#\)</span> to run the code.</p>
<p>We see from the help page, and associated reference to the paper in the <em>American Statistician</em>,
that the data comes from asking women in Newcastle, England, whether they smoke or not,
and then following up in 20 years to see if they died. We can use these data to
observe any apparent association between smoking and mortality.</p>
<p>To investigate any such associations, we can simply look at the observed mortality rates
for smokers and non-smokers. This is our first <strong>statistic</strong>. What makes it a “statistic”?
Formally, a <strong>statistic</strong> is any summary—or <em>function</em>—of observed data. Here we
are going to report the <em>mortality rate</em>—the proportion of people who died—for smokers,
and non-smokers. These are both statistics, and reporting these two statistics side
by side is our first example of an <strong>exploratory data analysis</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># install.packages(&quot;tidyverse&quot;)</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">library</span>(tidyverse) <span class="co"># We use a LOT of functions from this package.</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># Compute the mortality rate for smokers and non-smokers.</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># To do this, create a dataframe containing the numbers of smokers</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># and non-smokers</span></a>
<a class="sourceLine" id="cb2-7" title="7">smoker_numbers &lt;-<span class="st"> </span>femsmoke <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># The %&gt;% operator lets you form sequences of operations</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(smoker) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># group_by() makes all the following operations happen within groups</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">num_people =</span> <span class="kw">sum</span>(y)) <span class="co"># Count the number of people who are smokers and not smokers </span></a>
<a class="sourceLine" id="cb2-10" title="10">smoker_numbers</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   smoker num_people
##   &lt;fct&gt;       &lt;dbl&gt;
## 1 yes           582
## 2 no            732</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Now, compute the number of people who died out of the smokers and non-smokers</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># This looks the same as above, except we now filter() only the people who died.</span></a>
<a class="sourceLine" id="cb4-3" title="3">smoker_numbers_dead &lt;-<span class="st"> </span>femsmoke <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">  </span><span class="kw">filter</span>(dead <span class="op">==</span><span class="st"> &quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Retains rows where dead == &quot;yes&quot; only</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(smoker) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">num_dead =</span> <span class="kw">sum</span>(y))</a>
<a class="sourceLine" id="cb4-7" title="7">smoker_numbers_dead</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   smoker num_dead
##   &lt;fct&gt;     &lt;dbl&gt;
## 1 yes         139
## 2 no          230</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Now, we join these two tables together and compute the mortality rates by group.</span></a>
<a class="sourceLine" id="cb6-2" title="2">smoker_numbers <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">inner_join</span>(smoker_numbers_dead,<span class="dt">by =</span> <span class="st">&quot;smoker&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Joins rows with the same value of &quot;smoker&quot;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mort_rate =</span> num_dead<span class="op">/</span>num_people) <span class="co"># mutate() creates a new variable, which can be a function of the other variables in the dataframe.</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   smoker num_people num_dead mort_rate
##   &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 yes           582      139     0.239
## 2 no            732      230     0.314</code></pre>
<p>See anything interesting?</p>
<p>What went wrong? Why are we observing that smokers have a <em>lower</em> mortality rate than
non-smokers? Two possibilites immediately come to mind:</p>
<ol style="list-style-type: decimal">
<li>The opposite is really true, however, we got a very unlikely dataset;</li>
<li>We made a mistake in our analysis.</li>
</ol>
<p>We will address the first notion when we discuss <strong>inferential statistics</strong> later
in the course. The second notion is more immediate. Did we make a mistake?</p>
<p>One thing we definitely did was ignore some present information. Specifically,
we also know how old the women were. How can we include this information in our
descriptive statistics? We can compute mortality rates by age:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">smoker_numbers_age &lt;-<span class="st"> </span>femsmoke <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">group_by</span>(smoker,age) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Now we&#39;re grouping by smoker AND age. The rest of the code remains unchanged.</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">summarize</span>(<span class="dt">num_people =</span> <span class="kw">sum</span>(y))</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5">smoker_numbers_age_dead &lt;-<span class="st"> </span>femsmoke <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">filter</span>(dead <span class="op">==</span><span class="st"> &quot;yes&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">group_by</span>(smoker,age) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">summarize</span>(<span class="dt">num_dead =</span> <span class="kw">sum</span>(y))</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10">smoker_numbers_age <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="kw">inner_join</span>(smoker_numbers_age_dead,<span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;smoker&quot;</span>,<span class="st">&quot;age&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="kw">mutate</span>(<span class="dt">mort_rate =</span> num_dead<span class="op">/</span>num_people)</a></code></pre></div>
<pre><code>## # A tibble: 14 x 5
## # Groups:   smoker [2]
##    smoker age   num_people num_dead mort_rate
##    &lt;fct&gt;  &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1 yes    18-24         55        2    0.0364
##  2 yes    25-34        124        3    0.0242
##  3 yes    35-44        109       14    0.128 
##  4 yes    45-54        130       27    0.208 
##  5 yes    55-64        115       51    0.443 
##  6 yes    65-74         36       29    0.806 
##  7 yes    75+           13       13    1     
##  8 no     18-24         62        1    0.0161
##  9 no     25-34        157        5    0.0318
## 10 no     35-44        121        7    0.0579
## 11 no     45-54         78       12    0.154 
## 12 no     55-64        121       40    0.331 
## 13 no     65-74        129      101    0.783 
## 14 no     75+           64       64    1</code></pre>
<p>Older people are more likely to die within the 20 year followup period.
However, examining the raw counts of people in each group, we also see that
<em>in these data, older people are less likely to smoke</em> than younger people. So
<em>in these data</em>, less smokers died, because less smokers were old, and more
old people died.</p>
<p>But was our first analysis wrong? No. Our first analysis was fine: we computed
the mortality rate in each group. The problem was in the reporting, or the way
we told the story. We didn’t provide enough information when we said “the mortality
rate for smokers was lower than for non-smokers”. We should have mentioned that
this is <em>averaging over all age groups</em>. Even when we include age in the analysis,
we ought to mention the fact that there are a whole lot of variables we <em>could</em>
have measured but didn’t, and we are implicitly averaging over these too.</p>
<p>Before moving on, get some practice doing exploratory analysis with the following
exercises:</p>
<p>### Exercises</p>
<ol style="list-style-type: decimal">
<li>How many non-smoking 18-24 year olds are there in the <code>femsmoke</code> data? Answer
first by reading the answer off of the table of mortality rates by age that was
just presented. Now compute the number yourself in the following two ways:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Use <code>group_by()</code> to group the data by <code>smoker</code> and <code>age</code>; <code>summarize()</code> to
compute the number of people in each <code>smoker/age</code> group, and then <code>filter()</code> to
retain only <code>smoker == &quot;yes&quot;</code> and <code>age == &quot;18-24&quot;</code>.</li>
<li>Use <code>filter(smoker == &quot;yes&quot;,age = &quot;18-24&quot;)</code> to filter by both these variables,
then use <code>summarize()</code> to compute the total number of people.</li>
</ol>
<ol style="list-style-type: decimal">
<li>What is the <em>relative risk</em> of mortality—the ratio of the mortality rates—for
smoking 18-24 year olds vs non-smoking 18-24 year olds? Compute the answer manually by
reading the numbers off the above table again. Then compute it using <code>R</code> by doing the
following:</li>
</ol>
<ul>
<li>Create two datasets using <code>filter()</code>: one containing smokers and one containing
non-smokers. <code>filter()</code> out only the 18-24 year olds. This gives you two datasets
each with only one row. For example, <code>smokers &lt;- femsmoke %&gt;% filter(smoker == &quot;yes&quot;,age = &quot;18-24&quot;)</code>.</li>
<li><code>inner_join()</code> the two datasets together, using <code>age</code> as the <code>by</code> variable:
<code>smokers %&gt;% inner_join(???,by = &quot;age&quot;)</code></li>
</ul>
<ol style="list-style-type: decimal">
<li><em>Advanced</em>: modify the above steps to create the following table of relative mortality rates. You should start from a cleaned up version of the mortality rate by age table:</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">rates_by_age &lt;-<span class="st"> </span>smoker_numbers_age <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">inner_join</span>(smoker_numbers_age_dead,<span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;smoker&quot;</span>,<span class="st">&quot;age&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">mutate</span>(<span class="dt">mort_rate =</span> num_dead<span class="op">/</span>num_people) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">ungroup</span>() <span class="co"># The data was previously grouped, we don&#39;t want this anymore</span></a></code></pre></div>
<p>Use <code>dplyr::select()</code> to remove and rename columns, see <code>?dplyr::select</code>.</p>
<pre><code>## # A tibble: 7 x 4
##   age   smoker_mort_rate nonsmoker_mort_rate relative_risk
##   &lt;fct&gt;            &lt;dbl&gt;               &lt;dbl&gt;         &lt;dbl&gt;
## 1 18-24           0.0364              0.0161         2.25 
## 2 25-34           0.0242              0.0318         0.760
## 3 35-44           0.128               0.0579         2.22 
## 4 45-54           0.208               0.154          1.35 
## 5 55-64           0.443               0.331          1.34 
## 6 65-74           0.806               0.783          1.03 
## 7 75+             1                   1              1</code></pre>
</div>
<div id="extended-example-the-state-of-rental-housing-in-toronto-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Extended example: the state of rental housing in Toronto</h2>
<p>We saw a basic example in the <code>smoking</code> data of how the choices that we make
while analyzing a dataset can lead to different conclusions. The <code>smoking</code>
data is quite small, and there aren’t that many choices to make. Let’s take a
look at something more complicated, modern, and topical.</p>
<p>The RentSafeTO: Apartment Building Standards program is designed to help renters
in the city of Toronto make informed choices about where to live, and to enforce
a minimum standard of quality upon rental units within the city. With rents
skyrocketing and home ownership not a reasonable option for most, having an
informed view of the rental market is imperative. It also helps keep leaders
accountable, specifically if we focus on social and community housing buildings.</p>
<p>Comprehensive and fairly clean data from the program, along with specific
information, is available at <a href="https://open.toronto.ca/dataset/apartment-building-evaluation/" class="uri">https://open.toronto.ca/dataset/apartment-building-evaluation/</a>.
Data for the following were downloaded on <code>2019/09/16</code>.</p>
<p>To start your analysis, go now and download the data
and open it in a spreadsheet and have a look. Familiarize yourselves with the
variable descriptions and how the data were collected. This somewhat tedious
task is a first step of <strong>any</strong> data analysis, in academia, industry, government,
or wherever.</p>
<p>The data are stored in a <code>.csv</code> file, which stands for “comma-separated-values”.
Storing data in a text file with a separator, usually a comma, is very common.
These are referred to as “flat files” in an industrial context, to distinguish
them from data stored in databases.</p>
<p>We may read the data into <code>R</code> using the <code>read_csv</code> function in the <code>readr</code> package.
The <code>readr</code> package is part of the <code>tidyverse</code> package that we used before, so if
you installed that package, you have it loaded.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># https://open.toronto.ca/dataset/apartment-building-evaluation/</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># install.packages(&quot;readr&quot;)</span></a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co"># Read the data in. This means call the readr::read_csv() function, point it</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co"># to where you saved the data on your computer, and then save the result to a</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co"># variable. I am naming this variable &#39;apartmentdata&#39;.</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co"># Type ?readr::read_csv if you want to read about this function.</span></a>
<a class="sourceLine" id="cb12-8" title="8">apartmentdata &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb12-9" title="9">  <span class="dt">file =</span> <span class="st">&quot;./data/apartment-data/toronto-apartment-building-evaluations.csv&quot;</span></a>
<a class="sourceLine" id="cb12-10" title="10">)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   EVALUATION_COMPLETED_ON = col_character(),
##   PROPERTY_TYPE = col_character(),
##   RESULTS_OF_SCORE = col_character(),
##   SITE_ADDRESS = col_character(),
##   WARD = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<p>The message displayed is telling you that <code>readr::read_csv()</code> guessed at what
kind of data were in each column, i.e. numbers, letters, dates, etc. You should
make sure, as I have while writing, that these are what you expect. You can
get a concise view of this dataset using the <code>glimpse</code> function in the <code>dplyr</code>
package, which is automatically loaded when you load the <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">glimpse</span>(apartmentdata)</a></code></pre></div>
<pre><code>## Observations: 3,446
## Variables: 32
## $ `_id`                       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1…
## $ BALCONY_GUARDS              &lt;dbl&gt; NA, NA, NA, NA, 5, NA, 5, 3, 4, 4, 3…
## $ CONFIRMED_STOREYS           &lt;dbl&gt; 28, 4, 3, 3, 29, 3, 7, 18, 17, 32, 4…
## $ CONFIRMED_UNITS             &lt;dbl&gt; 457, 15, 26, 10, 272, 12, 95, 287, 3…
## $ ELEVATORS                   &lt;dbl&gt; 4, NA, NA, NA, 5, NA, 5, 4, 5, 4, NA…
## $ ENTRANCE_DOORS_WINDOWS      &lt;dbl&gt; 3, 3, 3, 4, 5, 4, 4, 4, 3, 4, 4, 3, …
## $ ENTRANCE_LOBBY              &lt;dbl&gt; 4, 3, 3, 4, 5, 4, 4, 4, 4, 4, 4, 4, …
## $ EVALUATION_COMPLETED_ON     &lt;chr&gt; &quot;04/03/2019&quot;, &quot;05/24/2018&quot;, &quot;07/11/2…
## $ EXTERIOR_CLADDING           &lt;dbl&gt; 3, 4, 4, 4, 5, 4, 5, 4, 4, 3, 3, 4, …
## $ EXTERIOR_GROUNDS            &lt;dbl&gt; 3, 4, 3, 3, 5, 4, 5, 4, 3, 4, 3, 4, …
## $ EXTERIOR_WALKWAYS           &lt;dbl&gt; 3, 5, 4, 4, 5, 4, 5, 4, 3, 4, 4, 3, …
## $ GARBAGE_BIN_STORAGE_AREA    &lt;dbl&gt; 3, 4, 3, 3, 4, 3, 3, 3, 4, 4, 4, 4, …
## $ GARBAGE_CHUTE_ROOMS         &lt;dbl&gt; 3, NA, NA, NA, 5, NA, 5, 4, 3, 4, 5,…
## $ GRAFFITI                    &lt;dbl&gt; 5, 5, 5, 5, 5, 4, 5, 4, 3, 4, 5, 5, …
## $ INTERIOR_LIGHTING_LEVELS    &lt;dbl&gt; 3, 4, 4, 4, 5, 4, 4, 3, 3, 4, 3, 4, …
## $ INTERIOR_WALL_CEILING_FLOOR &lt;dbl&gt; 4, 3, 4, 4, 5, 4, 4, 3, 4, 4, 4, 3, …
## $ INTERNAL_GUARDS_HANDRAILS   &lt;dbl&gt; 3, 4, 3, 4, 5, 4, 5, 4, 4, 4, 5, 4, …
## $ NO_OF_AREAS_EVALUATED       &lt;dbl&gt; 18, 14, 14, 13, 19, 16, 17, 18, 19, …
## $ OTHER_FACILITIES            &lt;dbl&gt; 4, NA, NA, NA, 5, NA, NA, NA, NA, NA…
## $ PARKING_AREA                &lt;dbl&gt; 2, NA, NA, NA, 4, 3, 5, 2, 4, 4, 2, …
## $ PROPERTY_TYPE               &lt;chr&gt; &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;SO…
## $ RESULTS_OF_SCORE            &lt;chr&gt; &quot;Evaluation needs to be conducted in…
## $ RSN                         &lt;dbl&gt; 4365723, 4364249, 4408585, 4288126, …
## $ SCORE                       &lt;dbl&gt; 71, 77, 71, 78, 98, 76, 93, 72, 74, …
## $ SECURITY                    &lt;dbl&gt; 4, 3, 3, 4, 5, 4, 5, 3, 4, 4, 4, 4, …
## $ SITE_ADDRESS                &lt;chr&gt; &quot;2350  DUNDAS ST W&quot;, &quot;9  STAG HILL D…
## $ STAIRWELLS                  &lt;dbl&gt; 4, 4, 3, 4, 5, 4, 5, 4, 4, 4, 3, 4, …
## $ STORAGE_AREAS_LOCKERS       &lt;dbl&gt; NA, NA, NA, NA, NA, 4, NA, NA, 3, 4,…
## $ WARD                        &lt;chr&gt; &quot;04&quot;, &quot;19&quot;, &quot;11&quot;, &quot;04&quot;, &quot;07&quot;, &quot;03&quot;, …
## $ WATER_PEN_EXT_BLDG_ELEMENTS &lt;dbl&gt; 4, 4, 4, 4, 5, 4, 5, 4, 5, 3, 3, 4, …
## $ YEAR_BUILT                  &lt;dbl&gt; 1976, 1953, 1948, 1920, 2017, 1967, …
## $ YEAR_REGISTERED             &lt;dbl&gt; 2018, 2018, 2018, 2017, 2018, 2017, …</code></pre>
<p>That’s bigger than the <code>smoking</code> data! 3,446 rental apartment buildings, each with
32 factors measured. The buliding’s address and Ward number are in there, which are
helpful for characterizing neighbourhoods.</p>
<p>A Ward is an administrative district within the city that has a single city
counsellor. If I’m thinking about moving to, or within, Toronto, I want to know:
<strong>Do different wards have different quality housing?</strong>.</p>
<p>In order to address this question we need to decide on the following:</p>
<ul>
<li><strong>Variable of interest</strong>. How do we <em>quantify</em> our research question? We need
to pick a <em>measure of quality</em>. Picking different measures can lead to different
conclusions.</li>
<li><strong>Filters</strong>. Do we look at all apartment buildings? Should we look only at those
built after, or before, a certain date? Only those that meet a certain minimum,
or maximum, standard of quality according to our definition? Are there any other
kinds of decisions we might have to consider?</li>
<li><strong>Methods</strong>. What kind of statistical tools should we use to address our research
question? We need to pick descriptive statistics to report, and decide whether
we want to include other auxillary variables in the analysis.</li>
<li><strong>Conclusions</strong>. How do we report our results? Tables, charts, maps? Should we
include subjective, editorial commentary, or let the data speak for
themselves?</li>
</ul>
<p>This is already overwhelming! Let’s make an attempt at it. I propose:</p>
<ul>
<li>Our <strong>variable of interest</strong> should be <code>SCORE</code>, which you know (because you
read the documentation…) is the “overall score of the buliding”. Higher is
better. The actual formula is included in the documentation of the data.</li>
<li>We will <strong>filter</strong> the data to only include buildings where <code>PROPERTY_TYPE == 'PRIVATE'</code>,
which will restrict our analysis to not include social housing. The quality of social
housing is an important social justice issue (that you will investigate in the exercises)
but it’s somewhat separate (?) from the question of where to look for rental housing.</li>
<li>Our <strong>methods</strong> will include looking at a table of average scores for each ward.
We will also look at whether older or newer buildings receive better scores.</li>
<li>We will summarize our <strong>conclusions</strong> through a subjective assessment of the
above table of average scores.</li>
</ul>
<p>With these decisions made, we may proceed with our analysis using the <code>tidyverse</code>
as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># First, select only the columns you want</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co"># This isn&#39;t strictly necessary but trust me, it makes </span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># debugging WAY easier.</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co"># I&#39;m also renaming the columns so the dataframe looks prettier.</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co"># Again, trust me. This stuff matters.</span></a>
<a class="sourceLine" id="cb17-6" title="6">apartmentclean &lt;-<span class="st"> </span>apartmentdata <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">ward =</span> WARD,</a>
<a class="sourceLine" id="cb17-8" title="8">                <span class="dt">score =</span> SCORE,</a>
<a class="sourceLine" id="cb17-9" title="9">                <span class="dt">property_type =</span> PROPERTY_TYPE,</a>
<a class="sourceLine" id="cb17-10" title="10">                <span class="dt">year_built =</span> YEAR_BUILT</a>
<a class="sourceLine" id="cb17-11" title="11">  )</a>
<a class="sourceLine" id="cb17-12" title="12"><span class="kw">glimpse</span>(apartmentclean) <span class="co"># Much nicer!</span></a></code></pre></div>
<pre><code>## Observations: 3,446
## Variables: 4
## $ ward          &lt;chr&gt; &quot;04&quot;, &quot;19&quot;, &quot;11&quot;, &quot;04&quot;, &quot;07&quot;, &quot;03&quot;, &quot;17&quot;, &quot;17&quot;, &quot;0…
## $ score         &lt;dbl&gt; 71, 77, 71, 78, 98, 76, 93, 72, 74, 78, 73, 76, 57…
## $ property_type &lt;chr&gt; &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;SOCIAL HOUSING&quot;,…
## $ year_built    &lt;dbl&gt; 1976, 1953, 1948, 1920, 2017, 1967, 2015, 1970, 19…</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># Apply filter(s).</span></a>
<a class="sourceLine" id="cb19-2" title="2">apartmentfiltered &lt;-<span class="st"> </span>apartmentclean <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw">filter</span>(property_type <span class="op">==</span><span class="st"> &quot;PRIVATE&quot;</span>)</a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co"># When filtering, always compare the filtered and unfiltered data to ensure</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co"># the result is as expected:</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="kw">glimpse</span>(apartmentclean)</a></code></pre></div>
<pre><code>## Observations: 3,446
## Variables: 4
## $ ward          &lt;chr&gt; &quot;04&quot;, &quot;19&quot;, &quot;11&quot;, &quot;04&quot;, &quot;07&quot;, &quot;03&quot;, &quot;17&quot;, &quot;17&quot;, &quot;0…
## $ score         &lt;dbl&gt; 71, 77, 71, 78, 98, 76, 93, 72, 74, 78, 73, 76, 57…
## $ property_type &lt;chr&gt; &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;SOCIAL HOUSING&quot;,…
## $ year_built    &lt;dbl&gt; 1976, 1953, 1948, 1920, 2017, 1967, 2015, 1970, 19…</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">glimpse</span>(apartmentfiltered)</a></code></pre></div>
<pre><code>## Observations: 2,879
## Variables: 4
## $ ward          &lt;chr&gt; &quot;04&quot;, &quot;19&quot;, &quot;11&quot;, &quot;07&quot;, &quot;03&quot;, &quot;17&quot;, &quot;17&quot;, &quot;08&quot;, &quot;1…
## $ score         &lt;dbl&gt; 71, 77, 71, 98, 76, 93, 72, 74, 78, 73, 76, 57, 70…
## $ property_type &lt;chr&gt; &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVATE&quot;, &quot;PRIVA…
## $ year_built    &lt;dbl&gt; 1976, 1953, 1948, 2017, 1967, 2015, 1970, 1976, 19…</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">nrow</span>(apartmentclean) <span class="op">-</span><span class="st"> </span><span class="kw">nrow</span>(apartmentfiltered) <span class="co"># Dropped 567 rows.</span></a></code></pre></div>
<pre><code>## [1] 567</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># Now create the table of averages:</span></a>
<a class="sourceLine" id="cb25-2" title="2">apartmentfiltered <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(ward) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">avg_score =</span> <span class="kw">mean</span>(score))</a></code></pre></div>
<pre><code>## # A tibble: 26 x 2
##    ward  avg_score
##    &lt;chr&gt;     &lt;dbl&gt;
##  1 01         71.5
##  2 02         NA  
##  3 03         70.5
##  4 04         68.2
##  5 05         71.7
##  6 06         72.1
##  7 07         69.8
##  8 08         73.5
##  9 09         NA  
## 10 10         NA  
## # … with 16 more rows</code></pre>
<p>Bah! What happened? Why are there these <code>NA</code> values?</p>
<p><code>NA</code> is the value <code>R</code> uses to mean “missing”. We have to hope that whether a
rental apartment building’s <code>score</code> is missing <em>is not related</em> to what that score <em>is</em>,
that is, we hope apartments with higher or lower scores aren’t missing more often.</p>
<p>We will ignore missingness for now. To do this, use the <code>na.rm = TRUE</code> option in
<code>mean</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">apartmentfiltered <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">group_by</span>(ward) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">summarize</span>(<span class="dt">avg_score =</span> <span class="kw">mean</span>(score,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## # A tibble: 26 x 2
##    ward  avg_score
##    &lt;chr&gt;     &lt;dbl&gt;
##  1 01         71.5
##  2 02         73.0
##  3 03         70.5
##  4 04         68.2
##  5 05         71.7
##  6 06         72.1
##  7 07         69.8
##  8 08         73.5
##  9 09         67.5
## 10 10         72.2
## # … with 16 more rows</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="error.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
