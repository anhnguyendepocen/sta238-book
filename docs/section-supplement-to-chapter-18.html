<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Supplement to Chapter 18 | STA238: Probability, Statistics, and Data Analysis</title>
  <meta name="description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Supplement to Chapter 18 | STA238: Probability, Statistics, and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Supplement to Chapter 18 | STA238: Probability, Statistics, and Data Analysis" />
  
  <meta name="twitter:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

<meta name="author" content="Alison Gibbs and Alex Stringer" />


<meta name="date" content="2020-10-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-supplement-to-evans-rosenthal-section-7-1.html"/>
<link rel="next" href="section-supplement-to-chapter-21.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA238 University of Toronto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analysis: Data Input and Basic Summaries</a><ul>
<li class="chapter" data-level="2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-old-faithful"><i class="fa fa-check"></i><b>2.1</b> Old Faithful</a><ul>
<li class="chapter" data-level="2.1.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-the-data"><i class="fa fa-check"></i><b>2.1.1</b> Read in the data</a></li>
<li class="chapter" data-level="2.1.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Graphical Summaries</a></li>
<li class="chapter" data-level="2.1.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries"><i class="fa fa-check"></i><b>2.1.3</b> Numerical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-drilling"><i class="fa fa-check"></i><b>2.2</b> Drilling</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-data"><i class="fa fa-check"></i><b>2.2.1</b> Read in data</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries-1"><i class="fa fa-check"></i><b>2.2.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="2.2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries-1"><i class="fa fa-check"></i><b>2.2.3</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
<li class="chapter" data-level="2.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-extended-example-smoking-and-age-and-mortality"><i class="fa fa-check"></i><b>2.4</b> Extended example: smoking and age and mortality</a><ul>
<li class="chapter" data-level="2.4.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-association-between-smoking-and-mortality"><i class="fa fa-check"></i><b>2.4.2</b> Association between smoking and mortality</a></li>
<li class="chapter" data-level="2.4.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-2"><i class="fa fa-check"></i><b>2.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-case-study-rental-housing-in-toronto"><i class="fa fa-check"></i><b>2.5</b> Case study: rental housing in Toronto</a><ul>
<li class="chapter" data-level="2.5.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-load-the-data"><i class="fa fa-check"></i><b>2.5.1</b> Load the data</a></li>
<li class="chapter" data-level="2.5.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-i-what-does-the-data-look-like"><i class="fa fa-check"></i><b>2.5.2</b> Analysis I: what does the data look like?</a></li>
<li class="chapter" data-level="2.5.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-ii-do-different-wards-have-different-quality-housing"><i class="fa fa-check"></i><b>2.5.3</b> Analysis II: Do different wards have different quality housing?</a></li>
<li class="chapter" data-level="2.5.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-iii-trends-in-quality-over-time"><i class="fa fa-check"></i><b>2.5.4</b> Analysis III: trends in quality over time</a></li>
<li class="chapter" data-level="2.5.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-summary"><i class="fa fa-check"></i><b>2.5.5</b> Summary</a></li>
<li class="chapter" data-level="2.5.6" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-3"><i class="fa fa-check"></i><b>2.5.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><i class="fa fa-check"></i><b>3</b> Introduction to Statistics: Law of Large Numbers and Central Limit Theorem</a><ul>
<li class="chapter" data-level="3.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-law-of-large-numbers-chapter-13"><i class="fa fa-check"></i><b>3.1</b> Law of Large Numbers (Chapter 13)</a><ul>
<li class="chapter" data-level="3.1.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads"><i class="fa fa-check"></i><b>3.1.1</b> Extended example: the probability of heads</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-central-limit-theorem-chapter-14"><i class="fa fa-check"></i><b>3.2</b> Central Limit Theorem (Chapter 14)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads-1"><i class="fa fa-check"></i><b>3.2.1</b> Extended example: the probability of heads</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-statistical-models.html"><a href="section-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Statistical Models</a><ul>
<li class="chapter" data-level="4.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-statistical-models-chapter-17"><i class="fa fa-check"></i><b>4.1</b> Statistical models (Chapter 17)</a><ul>
<li class="chapter" data-level="4.1.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-linear-regression"><i class="fa fa-check"></i><b>4.1.1</b> Linear Regression</a></li>
<li class="chapter" data-level="4.1.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-extended-example-ttc-ridership-revenues"><i class="fa fa-check"></i><b>4.1.2</b> Extended example: TTC ridership revenues</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-unbiased-estimators-chapter-19"><i class="fa fa-check"></i><b>4.2</b> Unbiased Estimators (Chapter 19)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-simulated-data"><i class="fa fa-check"></i><b>4.2.1</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><i class="fa fa-check"></i><b>5</b> Evaluating Estimators: Efficiency and Mean Squared Error</a><ul>
<li class="chapter" data-level="5.1" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-estimating-a-uniform-maximum"><i class="fa fa-check"></i><b>5.1</b> Estimating a Uniform Maximum</a></li>
<li class="chapter" data-level="5.2" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-efficiency"><i class="fa fa-check"></i><b>5.2</b> Efficiency</a></li>
<li class="chapter" data-level="5.3" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-mean-squared-error"><i class="fa fa-check"></i><b>5.3</b> Mean Squared Error</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html"><i class="fa fa-check"></i><b>6</b> Supplement to Evans &amp; Rosenthal Section 7.1</a><ul>
<li class="chapter" data-level="6.1" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-tutorial"><i class="fa fa-check"></i><b>6.1</b> Tutorial</a><ul>
<li class="chapter" data-level="6.1.1" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-frequentistlikelihood-perspective"><i class="fa fa-check"></i><b>6.1.1</b> Frequentist/Likelihood Perspective</a></li>
<li class="chapter" data-level="6.1.2" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-bayesian-inference-introduction"><i class="fa fa-check"></i><b>6.1.2</b> Bayesian Inference: introduction</a></li>
<li class="chapter" data-level="6.1.3" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-flipping-more-coins"><i class="fa fa-check"></i><b>6.1.3</b> Flipping More Coins</a></li>
<li class="chapter" data-level="6.1.4" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-visualization"><i class="fa fa-check"></i><b>6.1.4</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="section-supplement-to-evans-rosenthal-section-7-1.html"><a href="section-supplement-to-evans-rosenthal-section-7-1.html#section-interactive-app"><i class="fa fa-check"></i><b>6.2</b> Interactive App</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="section-supplement-to-chapter-18.html"><a href="section-supplement-to-chapter-18.html"><i class="fa fa-check"></i><b>7</b> Supplement to Chapter 18</a><ul>
<li class="chapter" data-level="7.1" data-path="section-supplement-to-chapter-18.html"><a href="section-supplement-to-chapter-18.html#section-the-bootstrap-chapter-18"><i class="fa fa-check"></i><b>7.1</b> The Bootstrap (Chapter 18)</a><ul>
<li class="chapter" data-level="7.1.1" data-path="section-supplement-to-chapter-18.html"><a href="section-supplement-to-chapter-18.html#section-empirical-bootstrap-old-faithful-data"><i class="fa fa-check"></i><b>7.1.1</b> Empirical bootstrap: Old Faithful data</a></li>
<li class="chapter" data-level="7.1.2" data-path="section-supplement-to-chapter-18.html"><a href="section-supplement-to-chapter-18.html#section-parametric-bootstrap-software-data"><i class="fa fa-check"></i><b>7.1.2</b> Parametric Bootstrap: software data</a></li>
<li class="chapter" data-level="7.1.3" data-path="section-supplement-to-chapter-18.html"><a href="section-supplement-to-chapter-18.html#section-extended-example-the-standard-error-of-a-proportion"><i class="fa fa-check"></i><b>7.1.3</b> Extended example: the standard error of a proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html"><i class="fa fa-check"></i><b>8</b> Supplement to Chapter 21</a><ul>
<li class="chapter" data-level="8.1" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html#section-maximum-likelihood-chapter-21"><i class="fa fa-check"></i><b>8.1</b> Maximum Likelihood (Chapter 21)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html#section-example-two-coins"><i class="fa fa-check"></i><b>8.1.1</b> Example: two coins</a></li>
<li class="chapter" data-level="8.1.2" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html#section-example-unknown-coins-n-2"><i class="fa fa-check"></i><b>8.1.2</b> Example: unknown coins, <span class="math inline">\(n = 2\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html#section-example-unknown-coins-n-bigger-than-2"><i class="fa fa-check"></i><b>8.1.3</b> Example: unknown coins, <span class="math inline">\(n\)</span> bigger than <span class="math inline">\(2\)</span></a></li>
<li class="chapter" data-level="8.1.4" data-path="section-supplement-to-chapter-21.html"><a href="section-supplement-to-chapter-21.html#section-extended-example-rental-housing-in-toronto"><i class="fa fa-check"></i><b>8.1.4</b> Extended example: rental housing in Toronto</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html"><i class="fa fa-check"></i><b>9</b> Supplement to Chapter 23 and 24</a><ul>
<li class="chapter" data-level="9.1" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-confidence-intervals-for-the-mean-chapter-23"><i class="fa fa-check"></i><b>9.1</b> Confidence Intervals for the Mean (Chapter 23)</a><ul>
<li class="chapter" data-level="9.1.1" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-simulation"><i class="fa fa-check"></i><b>9.1.1</b> Simulation</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-gross-calorific-value-measurements-for-osterfeld-262de27"><i class="fa fa-check"></i><b>9.1.2</b> Gross calorific value measurements for Osterfeld 262DE27</a></li>
<li class="chapter" data-level="9.1.3" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-gross-calorific-value-measurements-for-daw-mill-258gb41"><i class="fa fa-check"></i><b>9.1.3</b> Gross calorific value measurements for Daw Mill 258GB41</a></li>
<li class="chapter" data-level="9.1.4" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>9.1.4</b> Bootstrap Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-more-on-confidence-intervals-chapter-24"><i class="fa fa-check"></i><b>9.2</b> More on confidence intervals (Chapter 24)</a><ul>
<li class="chapter" data-level="9.2.1" data-path="section-supplement-to-chapter-23-and-24.html"><a href="section-supplement-to-chapter-23-and-24.html#section-binomial-distribution"><i class="fa fa-check"></i><b>9.2.1</b> Binomial distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html"><i class="fa fa-check"></i><b>10</b> Extended Example: Reasoning About Goodness of Fit</a><ul>
<li class="chapter" data-level="10.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-go-and-read-the-blog-post"><i class="fa fa-check"></i><b>10.1</b> Go and read the blog post</a></li>
<li class="chapter" data-level="10.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-distribution-of-last-digits"><i class="fa fa-check"></i><b>10.2</b> Distribution of last digits</a><ul>
<li class="chapter" data-level="10.2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-the-data"><i class="fa fa-check"></i><b>10.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="10.2.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-make-the-histogram"><i class="fa fa-check"></i><b>10.2.2</b> Make the histogram</a></li>
<li class="chapter" data-level="10.2.3" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-simulation"><i class="fa fa-check"></i><b>10.2.3</b> Testing goodness of fit: simulation</a></li>
<li class="chapter" data-level="10.2.4" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-math"><i class="fa fa-check"></i><b>10.2.4</b> Testing goodness of fit: math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html"><i class="fa fa-check"></i><b>11</b> Supplement to Evans &amp; Rosenthal Section 7.2</a><ul>
<li class="chapter" data-level="11.1" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-estimation-in-bayesian-inference-general-ideas"><i class="fa fa-check"></i><b>11.1</b> Estimation in Bayesian Inference: general ideas</a><ul>
<li class="chapter" data-level="11.1.1" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-the-prior"><i class="fa fa-check"></i><b>11.1.1</b> The Prior</a></li>
<li class="chapter" data-level="11.1.2" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-the-posterior"><i class="fa fa-check"></i><b>11.1.2</b> The Posterior</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-estimation-in-bayesian-inference-point-and-interval-estimation"><i class="fa fa-check"></i><b>11.2</b> Estimation in Bayesian Inference: point and interval estimation</a></li>
<li class="chapter" data-level="11.3" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-choosing-a-prior"><i class="fa fa-check"></i><b>11.3</b> Choosing a Prior</a><ul>
<li class="chapter" data-level="11.3.1" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-conjugate-priors"><i class="fa fa-check"></i><b>11.3.1</b> Conjugate Priors</a></li>
<li class="chapter" data-level="11.3.2" data-path="section-supplement-to-evans-rosenthal-section-7-2.html"><a href="section-supplement-to-evans-rosenthal-section-7-2.html#section-setting-hyperparameters-by-moment-matching"><i class="fa fa-check"></i><b>11.3.2</b> Setting Hyperparameters by moment-matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html"><i class="fa fa-check"></i><b>12</b> Predictive Modelling</a><ul>
<li class="chapter" data-level="12.1" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-plug-in-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.2</b> Plug-in prediction: coin flipping</a></li>
<li class="chapter" data-level="12.3" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-bayesian-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.3</b> Bayesian Prediction: coin flipping</a></li>
<li class="chapter" data-level="12.4" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-extended-example-income-and-advertsing-datasets"><i class="fa fa-check"></i><b>12.4</b> Extended example: Income and Advertsing datasets</a></li>
<li class="chapter" data-level="12.5" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-extended-example-predicting-call-centre-wait-times"><i class="fa fa-check"></i><b>12.5</b> Extended example: predicting call centre wait times</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>13</b> Installing R and RStudio</a><ul>
<li class="chapter" data-level="13.1" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-r"><i class="fa fa-check"></i><b>13.1</b> Installing R</a></li>
<li class="chapter" data-level="13.2" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-using-rmarkdown"><i class="fa fa-check"></i><b>13.3</b> Using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html"><i class="fa fa-check"></i><b>14</b> Assigned Exercises from MIPS</a><ul>
<li class="chapter" data-level="14.1" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-15-and-16"><i class="fa fa-check"></i><b>14.1</b> Chapters 15 and 16</a></li>
<li class="chapter" data-level="14.2" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-13-and-14"><i class="fa fa-check"></i><b>14.2</b> Chapters 13 and 14</a></li>
<li class="chapter" data-level="14.3" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-17-and-19"><i class="fa fa-check"></i><b>14.3</b> Chapters 17 and 19</a></li>
<li class="chapter" data-level="14.4" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-20"><i class="fa fa-check"></i><b>14.4</b> Chapter 20</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA238: Probability, Statistics, and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-supplement-to-chapter-18" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Supplement to Chapter 18</h1>
<p>This chapter implements much of the analysis shown in chapter 18 of
A Modern Introduction to Probability and Statistics. R code is given for the
simple textbook datasets used in the book, and then the concepts are
illustrated on real data.</p>
<p>All datasets from the book can be downloaded here: <a href="https://www.tudelft.nl/en/eemcs/the-faculty/departments/applied-mathematics/applied-probability/education/mips/" class="uri">https://www.tudelft.nl/en/eemcs/the-faculty/departments/applied-mathematics/applied-probability/education/mips/</a>.</p>
<p>The assigned exercises associated with this material are from MIPS, as follows: 18.1 18.2; 18.3, 18.4; 18.6; 18.7; 18.8; 18.9; 18.11. Answers to selected exercises are in the
back of the book. You should also do all the “quick exercises” within chapter 18
(solutions are at the end of the chapter). Use <code>R</code> as much as possible when answering the
questions.</p>
<div id="section-the-bootstrap-chapter-18" class="section level2">
<h2><span class="header-section-number">7.1</span> The Bootstrap (Chapter 18)</h2>
<p>The bootstrap is one of the most foundational computational tools in modern
statistics. It as important on the computation side as basic calculus is on the
math side. Any time you have an estimator and are interested in its repeated
sampling properties (which is much of what statistics <em>is</em>), you can simulate
data, compute the estimator, and just <em>look</em> at the results to get an idea
of what’s going on. This is called the “parametric” bootstrap, and you have
been doing it for the whole course in these supplementary notes.</p>
<p>This chapter introduces the “empirical” bootstrap, which allows you to use this
idea when you don’t know the distribution of the data! The idea is to sample
with replacement from the data that you have. A lot of the statistical properties
of estimators are still recoverable under this type of sampling.</p>
<p>It seems like magic. Indeed, the name “bootstrap” comes from the old expression
“lift yourself up by your bootstraps”, which roughly means to do something
seemingly impossible or contradictory in order to better your situation. One
of the best-named concepts in all of stats, in my opinion.</p>
<div id="section-empirical-bootstrap-old-faithful-data" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Empirical bootstrap: Old Faithful data</h3>
<p>Let’s recreate Figure 18.1:</p>
<div class="sourceCode" id="section-cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.2.1     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.3
## ✓ tidyr   1.0.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="section-cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># Read in old faithful, copied from chapter 1:</span></a>
<a class="sourceLine" id="cb5-2" title="2">oldfaithful &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">file =</span> <span class="st">&quot;data/MIPSdata/oldfaithful.txt&quot;</span>, <span class="co"># Tell it where the file is</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">col_names =</span> <span class="st">&quot;time&quot;</span>, <span class="co"># Tell it that the first row is NOT column names, and at the same time, tell it what name you want for the column.</span></a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="dt">col_types =</span> <span class="st">&quot;n&quot;</span> <span class="co"># Tell it that there is one column, and it is &quot;numeric&quot; (n)</span></a>
<a class="sourceLine" id="cb5-6" title="6">)</a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># Check what was read in using the dplyr::glimpse() function</span></a>
<a class="sourceLine" id="cb5-8" title="8">dplyr<span class="op">::</span><span class="kw">glimpse</span>(oldfaithful)</a></code></pre></div>
<pre><code>## Observations: 272
## Variables: 1
## $ time &lt;dbl&gt; 216, 108, 200, 137, 272, 173, 282, 216, 117, 261, 110, 235, 252,…</code></pre>
<div class="sourceCode" id="section-cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Bootstrap: sample with replacement</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">set.seed</span>(<span class="dv">45356</span>) <span class="co"># So you can reproduce my results</span></a>
<a class="sourceLine" id="cb7-3" title="3">B &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of bootstrap resamples to take</span></a>
<a class="sourceLine" id="cb7-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(oldfaithful) <span class="co"># Sample size</span></a>
<a class="sourceLine" id="cb7-5" title="5">bootstrapmeans &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>B <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">sample</span>(oldfaithful<span class="op">$</span>time,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span>(<span class="kw">mean</span>(.x) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(oldfaithful<span class="op">$</span>time))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Compute the CENTRED mean</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">  </span><span class="kw">reduce</span>(c)</a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co"># Plot the hisrogram and density estimate together</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="kw">tibble</span>(<span class="dt">x =</span> bootstrapmeans) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..),<span class="dt">bins =</span> <span class="dv">20</span>,<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">18</span>,<span class="dv">18</span>,<span class="dt">by=</span><span class="dv">6</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">18</span>,<span class="dv">18</span>))</a></code></pre></div>
<p><img src="book_files/figure-html/faithful-1-1.png" width="672" /></p>
<p><strong>Exercise</strong>: compute the book’s estimate of <span class="math inline">\(P(|\bar{X}_{n} - \mu|)\)</span>. Using the
above <code>set.seed(45356)</code> I got the following (slightly different than the book):</p>
<pre><code>## [1] 0.216</code></pre>
<p><strong>Exercise</strong>: now, repeat the entire bootstrap procedure <span class="math inline">\(1000\)</span> times and
plot a histogram and kernel density estimate of <span class="math inline">\(P(|\bar{X}_{n} - \mu|)\)</span>.
I got the following with <code>set.seed(8768432)</code>:</p>
<p><img src="book_files/figure-html/faithful-3-1.png" width="672" /></p>
</div>
<div id="section-parametric-bootstrap-software-data" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Parametric Bootstrap: software data</h3>
<p>Read in the software data. Try to do it yourself before looking:</p>
<div class="sourceCode" id="section-cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="fu">head</span> data/MIPSdata/software.txt</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="fu">wc</span> -l data/MIPSdata/software.txt</a></code></pre></div>
<pre><code>## 30  
## 113  
## 81  
## 115  
## 9  
## 2  
## 91  
## 112  
## 15  
## 138
##      136 data/MIPSdata/software.txt</code></pre>
<div class="sourceCode" id="section-cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">software &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">file =</span> <span class="st">&quot;data/MIPSdata/software.txt&quot;</span>,</a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="dt">col_names =</span> <span class="st">&quot;time&quot;</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="dt">col_types =</span> <span class="st">&quot;n&quot;</span></a>
<a class="sourceLine" id="cb11-5" title="5">)</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">glimpse</span>(software)</a></code></pre></div>
<pre><code>## Observations: 136
## Variables: 1
## $ time &lt;dbl&gt; 30, 113, 81, 115, 9, 2, 91, 112, 15, 138, 50, 77, 24, 108, 88, 6…</code></pre>
<p>Plot the CDF of the estimated distribution against the empirical CDF of the data.
The <span class="math inline">\(t_{ks}\)</span> described in the book is the maximum vertical distance between these
two curves:</p>
<div class="sourceCode" id="section-cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">lambdahat &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">mean</span>(software<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb13-2" title="2">samppoints &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>,<span class="dt">by=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-3" title="3">expcdf &lt;-<span class="st"> </span><span class="kw">pexp</span>(samppoints,<span class="dt">rate =</span> lambdahat)</a>
<a class="sourceLine" id="cb13-4" title="4">empcdf &lt;-<span class="st"> </span><span class="kw">ecdf</span>(software<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw">tibble</span>(<span class="dt">x =</span> samppoints,<span class="dt">y =</span> expcdf) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> empcdf,<span class="dt">linetype =</span> <span class="st">&quot;dotdash&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/software-3-1.png" width="672" /></p>
<p>Compute a bootstrap sample of <span class="math inline">\(T_{ks}\)</span>:</p>
<div class="sourceCode" id="section-cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">97876856</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">compute_tks &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb14-3" title="3">  samppoints &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>,<span class="dt">by=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(software)</a>
<a class="sourceLine" id="cb14-5" title="5">  samp &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dt">rate =</span> lambdahat)</a>
<a class="sourceLine" id="cb14-6" title="6">  ecdfboot &lt;-<span class="st"> </span><span class="kw">ecdf</span>(samp)(samppoints)</a>
<a class="sourceLine" id="cb14-7" title="7">  expcdf &lt;-<span class="st"> </span><span class="kw">pexp</span>(samppoints,<span class="dt">rate =</span> lambdahat)</a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="kw">max</span>(<span class="kw">abs</span>(ecdfboot <span class="op">-</span><span class="st"> </span>expcdf))</a>
<a class="sourceLine" id="cb14-9" title="9">}</a>
<a class="sourceLine" id="cb14-10" title="10">B &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-11" title="11">tksboot &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>B <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">compute_tks</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">reduce</span>(c)</a>
<a class="sourceLine" id="cb14-12" title="12"><span class="kw">tibble</span>(<span class="dt">x =</span> tksboot) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..),<span class="dt">bins =</span> <span class="dv">20</span>,<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,.<span class="dv">2</span>,<span class="dt">by=</span>.<span class="dv">05</span>),.<span class="dv">176</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">2</span>))</a></code></pre></div>
<p><img src="book_files/figure-html/software-4-1.png" width="672" /></p>
<p><strong>Exercise</strong>: the above <code>compute_tks()</code> is a bit tricky. Write out the exact algorithm
I use to compute <span class="math inline">\(T_{ks}\)</span>. Basically I am asking you to expand on step 2. of the
algorithm presented in the book on page 279.</p>
</div>
<div id="section-extended-example-the-standard-error-of-a-proportion" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Extended example: the standard error of a proportion</h3>
<p>Dozens of news articles are published every day with claims that “xx% of Canadians
say that yy”, where xx is some percentage and yy is some claim that the news
company wants to make. These articles have a significant impact on our public
discourse.</p>
<p>How could it be that every day, there are so many earth-shattering claims? It’s
almost like most of them aren’t actually true. But then why are they published,
and why do we believe them?</p>
<p>The missing ingredient is <em>variability</em>. These news articles most often only
report <em>point estimates</em>– the “xx%”. They don’t report the <em>standard error</em> of
these estimates, which give you a measure of the variability, and hence uncertainty,
in the conclusions that are made based off of them.</p>
<p>We can use the bootstrap to get an idea of the variability in estimates based off
of surveys. Because most news articles don’t link to the raw data (another reason
not to believe the stuff that these for-profit companies push), we’ll use a general
budget survey from the Government of Canada, with responses from Alberta residents.
You can get the data in excel format <a href="here">https://open.canada.ca/data/en/dataset/2a5992c4-a050-46b8-b735-641cbc799a8e</a>.
You should open the file in excel and save it as a <code>.csv</code>, or if you don’t have excel,
I put the <code>.csv</code> file I used in the <code>data</code> folder.</p>
<p>Let’s read the data into <code>R</code>. We know it has a header row (because we opened it
in excel). There is a numeric ID column, two date columns (which we don’t need),
and 58 numeric response columns. I removed the first three (blank) and fourth (information)
rows from my
.csv, and you should do the same in excel if you have it.</p>
<div class="sourceCode" id="section-cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">col_types &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="st">&quot;ncc&quot;</span>,</a>
<a class="sourceLine" id="cb15-3" title="3">  stringr<span class="op">::</span><span class="kw">str_c</span>(<span class="kw">rep</span>(<span class="st">&quot;n&quot;</span>,<span class="dv">58</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_c</span>(<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb15-6" title="6">col_types <span class="co"># Understand the above code by running it in pieces and looking at the results.</span></a></code></pre></div>
<pre><code>## [1] &quot;nccnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn&quot;</code></pre>
<div class="sourceCode" id="section-cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">budget &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="dt">file =</span> <span class="st">&quot;data/budget.csv&quot;</span>,</a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="dt">col_names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="dt">col_types =</span> col_types</a>
<a class="sourceLine" id="cb17-5" title="5">)</a></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X17&#39; [17], &#39;X18&#39; [18],
## &#39;X19&#39; [19], &#39;X20&#39; [20], &#39;X21&#39; [21], &#39;X22&#39; [22], &#39;X23&#39; [23], &#39;X24&#39; [24],
## &#39;X26&#39; [26], &#39;X27&#39; [27], &#39;X28&#39; [28], &#39;X29&#39; [29], &#39;X30&#39; [30], &#39;X31&#39; [31],
## &#39;X33&#39; [33], &#39;X34&#39; [34], &#39;X35&#39; [35], &#39;X36&#39; [36], &#39;X37&#39; [37], &#39;X38&#39; [38],
## &#39;X39&#39; [39], &#39;X40&#39; [40], &#39;X41&#39; [41], &#39;X42&#39; [42], &#39;X44&#39; [44], &#39;X45&#39; [45],
## &#39;X46&#39; [46], &#39;X47&#39; [47], &#39;X48&#39; [48], &#39;X49&#39; [49], &#39;X50&#39; [50], &#39;X51&#39; [51],
## &#39;X52&#39; [52], &#39;X53&#39; [53], &#39;X55&#39; [55], &#39;X56&#39; [56], &#39;X57&#39; [57], &#39;X58&#39; [58],
## &#39;X59&#39; [59]</code></pre>
<div class="sourceCode" id="section-cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">glimpse</span>(budget)</a></code></pre></div>
<pre><code>## Observations: 40,513
## Variables: 61
## $ `Respond-ent ID`                                                                                                                                                                                                                &lt;dbl&gt; …
## $ StartDate                                                                                                                                                                                                                       &lt;chr&gt; …
## $ CompletedDate                                                                                                                                                                                                                   &lt;chr&gt; …
## $ `Q1: To what extent do you think low oil prices impact the Alberta government&#39;s ability to budget?`                                                                                                                             &lt;dbl&gt; …
## $ `Q2: How concerned are you about the $7B shortfall?`                                                                                                                                                                            &lt;dbl&gt; …
## $ `Q3: Should government take action now, wait six months, or hold out for high oil prices?`                                                                                                                                      &lt;dbl&gt; …
## $ `Q4: Government needs:`                                                                                                                                                                                                         &lt;dbl&gt; …
## $ `Question 5 a) Cut spending`                                                                                                                                                                                                    &lt;dbl&gt; …
## $ `Question 5 b) Raise taxes and user fees`                                                                                                                                                                                       &lt;dbl&gt; …
## $ `Question 5 c) Borrow money`                                                                                                                                                                                                    &lt;dbl&gt; …
## $ `Question 6 a) Reduce expenditures`                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Question 6 b) Raise taxes and user fees`                                                                                                                                                                                       &lt;dbl&gt; …
## $ `Question 6 c) Run a deficit`                                                                                                                                                                                                   &lt;dbl&gt; …
## $ `Q7: Are current tax rates in Alberta higher, above average or lower?`                                                                                                                                                          &lt;dbl&gt; …
## $ `Q8: How important is it that AB taxes are lower?`                                                                                                                                                                              &lt;dbl&gt; …
## $ `Q9: In what ways can the government act to increase revenue without jeopardizing Alberta&#39;s competitive position?  (1 = selected; 0 = not selected)`                                                                            &lt;dbl&gt; …
## $ X17                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X18                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X19                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X20                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X21                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X22                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X23                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X24                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Q10: If the government needs to increase its revenues through taxation, are there options you feel should NOT be considered?                                                                 (1 = selected; 0 = not selected)` &lt;dbl&gt; …
## $ X26                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X27                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X28                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X29                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X30                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X31                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Q11: Where would you tolerate cuts?  (1 = Selected; 0 = Not Selected)`                                                                                                                                                         &lt;dbl&gt; …
## $ X33                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X34                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X35                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X36                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X37                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X38                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X39                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X40                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X41                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X42                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Q12: And are there options you feel should NOT be touched?  (1 = Selected; 0 = Not selected)`                                                                                                                                  &lt;dbl&gt; …
## $ X44                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X45                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X46                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X47                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X48                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X49                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X50                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X51                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X52                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X53                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Q13: Indicate whether you Don&#39;t Know, Disagree or Agree.  (1 =  Don&#39;t know; 2 = Disagree; 3 = Agree)`                                                                                                                          &lt;dbl&gt; …
## $ X55                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X56                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X57                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X58                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ X59                                                                                                                                                                                                                             &lt;dbl&gt; …
## $ `Q15: Years you&#39;ve lived in AB`                                                                                                                                                                                                 &lt;dbl&gt; …
## $ `Q16: What part of the province do you live in?`                                                                                                                                                                                &lt;dbl&gt; …</code></pre>
<p>Ugly! There are some missing column names that were in the fourth row. If we needed
all these data, we would have to go in excel and manually label the columns correctly,
since the analysts at the government didn’t.</p>
<p>Look at the column names and start to think about the kind of news headlines they could
generate. I like the first one: “Q1: To what extent do you think low oil prices impact the Alberta government’s ability to budget?” could lead to things like “Albertans have given up hope: more than half
of Albertans believe their province is unable to budget due to the low price of oil.” Hey,
it generates clicks!</p>
<p>Here, let’s estimate the proportion of Albertans who would answer <span class="math inline">\(1\)</span> (“A Great Deal”)
to the above question.</p>
<p><strong>Exercise</strong>: there are 40513 survey responses. The number who respond 1
can be modelled as a Binomial random variable. Derive and calculate the standard
deviation of the sample proportion of respondents who answered 1. I got <span class="math inline">\(0.0025\)</span>.
Is this higher or lower than you would expect with this number of respondents?</p>
<div class="sourceCode" id="section-cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">29394032</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">origsamp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(budget[[<span class="st">&quot;Q1: To what extent do you think low oil prices impact the Alberta government&#39;s ability to budget?&quot;</span>]] <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb21-3" title="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(origsamp)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co"># Convert to 0/1 indicator of response == 1</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># Sample proportion:</span></a>
<a class="sourceLine" id="cb21-6" title="6">phat &lt;-<span class="st"> </span><span class="kw">mean</span>(origsamp)</a>
<a class="sourceLine" id="cb21-7" title="7">phat</a></code></pre></div>
<pre><code>## [1] 0.5377533</code></pre>
<div class="sourceCode" id="section-cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># Standard error (you should DERIVE this formula):</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">sqrt</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">/</span>n)</a></code></pre></div>
<pre><code>## [1] 0.00247703</code></pre>
<div class="sourceCode" id="section-cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># So the mean is .5378 and the standard error is about 0.0025 (theoretically).</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># Bootstrap: repeatedly resample and calculate the mean. The estimated standard error</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co"># of the sample mean is then the standard error of these means.</span></a>
<a class="sourceLine" id="cb25-4" title="4">doboot &lt;-<span class="st"> </span><span class="cf">function</span>(B) {</a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="dv">1</span><span class="op">:</span>B <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">    </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">sample</span>(origsamp,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="st">    </span><span class="kw">map</span>(mean) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="st">    </span><span class="kw">reduce</span>(c)</a>
<a class="sourceLine" id="cb25-9" title="9">}</a>
<a class="sourceLine" id="cb25-10" title="10">bootmeans &lt;-<span class="st"> </span><span class="kw">doboot</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb25-11" title="11"><span class="kw">mean</span>(bootmeans) <span class="co"># Pretty close!</span></a></code></pre></div>
<pre><code>## [1] 0.5377662</code></pre>
<div class="sourceCode" id="section-cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">sd</span>(bootmeans) <span class="co"># Not bad at all!</span></a></code></pre></div>
<pre><code>## [1] 0.00244279</code></pre>
<div class="sourceCode" id="section-cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">tibble</span>(<span class="dt">x =</span> bootmeans) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..),<span class="dt">bins =</span> <span class="dv">30</span>,<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> rlang<span class="op">::</span><span class="kw">as_function</span>(<span class="op">~</span>n <span class="op">*</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="kw">round</span>(n <span class="op">*</span><span class="st"> </span>.x),<span class="dt">size =</span> n,<span class="dt">prob =</span> phat))) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Bootstrap distribution of the sample mean&quot;</span>,</a>
<a class="sourceLine" id="cb29-7" title="7">       <span class="dt">subtitle =</span> <span class="st">&quot;Curve: theoretical distribution&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/budget-2-1.png" width="672" /></p>
<p><strong>Exercise</strong>: inside <code>stat_function(fun = rlang::as_function(~n * dbinom(round(n * .x),size = n,prob = phat)))</code> I
specify the theoretical density of the sample mean. Derive this formula yourself using the change of variables
formula.</p>
<p><strong>Exercise</strong>: derive an appropriate <em>normal approximation to the binomial distribution</em> for use in this example.
Add it to the above plot using another <code>stat_function</code> call, with <code>colour = &quot;red&quot;</code> and <code>linetype = &quot;dotdash&quot;</code>. I got the following:</p>
<p><img src="book_files/figure-html/budget-3-1.png" width="672" /></p>
<p>The normal approximation looks pretty good!</p>
<p><strong>Exercise</strong>: suppose that based on this survey, a newspaper claims that “Albertans have given up hope: more than half
of Albertans believe their province is unable to budget due to the low price of oil.”.
Use the bootstrap to calculate the probability that their claim is true, by considering
whether each resampled sample mean is greater than .5. Using <code>set.seed(5647244)</code>, and
<span class="math inline">\(B = 1000\)</span> resamples, I got the following:</p>
<pre><code>## [1] 1</code></pre>
<p>What do you think about this? Is the newspaper’s claim substantiated by the data?</p>
<p><strong>Exercise</strong>: surveys usually aren’t this big. Repeat the above calculation but
on a subset of only <span class="math inline">\(n = 200\)</span> people. What do you get now?
Use <code>newsample &lt;- sample(origsamp,200,replace = FALSE)</code> and then repeate the
bootstrapping on the <code>newsample</code>. Use the same random seed.</p>
<pre><code>## [1] 0.688</code></pre>
<p>Are you going to check
the sample size next time you read a news article that reports survey results?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-supplement-to-evans-rosenthal-section-7-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-supplement-to-chapter-21.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
