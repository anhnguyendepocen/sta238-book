<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Introduction to Statistics: Law of Large Numbers and Central Limit Theorem | Probability, Statistics, and Data Analysis</title>
  <meta name="description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  <meta name="generator" content="bookdown 0.21.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Introduction to Statistics: Law of Large Numbers and Central Limit Theorem | Probability, Statistics, and Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Introduction to Statistics: Law of Large Numbers and Central Limit Theorem | Probability, Statistics, and Data Analysis" />
  
  <meta name="twitter:description" content="This book represents part of the course materials for STA238 at the University of Toronto" />
  

<meta name="author" content="Alison Gibbs and Alex Stringer" />


<meta name="date" content="2020-10-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"/>
<link rel="next" href="section-statistical-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA238 University of Toronto</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analysis: Data Input and Basic Summaries</a><ul>
<li class="chapter" data-level="2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-old-faithful"><i class="fa fa-check"></i><b>2.1</b> Old Faithful</a><ul>
<li class="chapter" data-level="2.1.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-the-data"><i class="fa fa-check"></i><b>2.1.1</b> Read in the data</a></li>
<li class="chapter" data-level="2.1.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries"><i class="fa fa-check"></i><b>2.1.2</b> Graphical Summaries</a></li>
<li class="chapter" data-level="2.1.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries"><i class="fa fa-check"></i><b>2.1.3</b> Numerical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-drilling"><i class="fa fa-check"></i><b>2.2</b> Drilling</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-read-in-data"><i class="fa fa-check"></i><b>2.2.1</b> Read in data</a></li>
<li class="chapter" data-level="2.2.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-graphical-summaries-1"><i class="fa fa-check"></i><b>2.2.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="2.2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-numerical-summaries-1"><i class="fa fa-check"></i><b>2.2.3</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a></li>
<li class="chapter" data-level="2.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-extended-example-smoking-and-age-and-mortality"><i class="fa fa-check"></i><b>2.4</b> Extended example: smoking and age and mortality</a><ul>
<li class="chapter" data-level="2.4.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-association-between-smoking-and-mortality"><i class="fa fa-check"></i><b>2.4.2</b> Association between smoking and mortality</a></li>
<li class="chapter" data-level="2.4.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-2"><i class="fa fa-check"></i><b>2.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-case-study-rental-housing-in-toronto"><i class="fa fa-check"></i><b>2.5</b> Case study: rental housing in Toronto</a><ul>
<li class="chapter" data-level="2.5.1" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-load-the-data"><i class="fa fa-check"></i><b>2.5.1</b> Load the data</a></li>
<li class="chapter" data-level="2.5.2" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-i-what-does-the-data-look-like"><i class="fa fa-check"></i><b>2.5.2</b> Analysis I: what does the data look like?</a></li>
<li class="chapter" data-level="2.5.3" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-ii-do-different-wards-have-different-quality-housing"><i class="fa fa-check"></i><b>2.5.3</b> Analysis II: Do different wards have different quality housing?</a></li>
<li class="chapter" data-level="2.5.4" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-analysis-iii-trends-in-quality-over-time"><i class="fa fa-check"></i><b>2.5.4</b> Analysis III: trends in quality over time</a></li>
<li class="chapter" data-level="2.5.5" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-summary"><i class="fa fa-check"></i><b>2.5.5</b> Summary</a></li>
<li class="chapter" data-level="2.5.6" data-path="section-introduction-to-data-analysis-data-input-and-basic-summaries.html"><a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html#section-exercises-3"><i class="fa fa-check"></i><b>2.5.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><i class="fa fa-check"></i><b>3</b> Introduction to Statistics: Law of Large Numbers and Central Limit Theorem</a><ul>
<li class="chapter" data-level="3.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-law-of-large-numbers-chapter-13"><i class="fa fa-check"></i><b>3.1</b> Law of Large Numbers (Chapter 13)</a><ul>
<li class="chapter" data-level="3.1.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads"><i class="fa fa-check"></i><b>3.1.1</b> Extended example: the probability of heads</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-central-limit-theorem-chapter-14"><i class="fa fa-check"></i><b>3.2</b> Central Limit Theorem (Chapter 14)</a><ul>
<li class="chapter" data-level="3.2.1" data-path="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html"><a href="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem.html#section-extended-example-the-probability-of-heads-1"><i class="fa fa-check"></i><b>3.2.1</b> Extended example: the probability of heads</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="section-statistical-models.html"><a href="section-statistical-models.html"><i class="fa fa-check"></i><b>4</b> Statistical Models</a><ul>
<li class="chapter" data-level="4.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-statistical-models-chapter-17"><i class="fa fa-check"></i><b>4.1</b> Statistical models (Chapter 17)</a><ul>
<li class="chapter" data-level="4.1.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-linear-regression"><i class="fa fa-check"></i><b>4.1.1</b> Linear Regression</a></li>
<li class="chapter" data-level="4.1.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-extended-example-ttc-ridership-revenues"><i class="fa fa-check"></i><b>4.1.2</b> Extended example: TTC ridership revenues</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-unbiased-estimators-chapter-19"><i class="fa fa-check"></i><b>4.2</b> Unbiased Estimators (Chapter 19)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="section-statistical-models.html"><a href="section-statistical-models.html#section-simulated-data"><i class="fa fa-check"></i><b>4.2.1</b> Simulated data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><i class="fa fa-check"></i><b>5</b> Evaluating Estimators: Efficiency and Mean Squared Error</a><ul>
<li class="chapter" data-level="5.1" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-estimating-a-uniform-maximum"><i class="fa fa-check"></i><b>5.1</b> Estimating a Uniform Maximum</a></li>
<li class="chapter" data-level="5.2" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-efficiency"><i class="fa fa-check"></i><b>5.2</b> Efficiency</a></li>
<li class="chapter" data-level="5.3" data-path="section-evaluating-estimators-efficiency-and-mean-squared-error.html"><a href="section-evaluating-estimators-efficiency-and-mean-squared-error.html#section-mean-squared-error"><i class="fa fa-check"></i><b>5.3</b> Mean Squared Error</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html"><i class="fa fa-check"></i><b>6</b> Introduction to Bayesian Inference</a><ul>
<li class="chapter" data-level="6.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-tutorial"><i class="fa fa-check"></i><b>6.1</b> Tutorial</a><ul>
<li class="chapter" data-level="6.1.1" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-frequentistlikelihood-perspective"><i class="fa fa-check"></i><b>6.1.1</b> Frequentist/Likelihood Perspective</a></li>
<li class="chapter" data-level="6.1.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-bayesian-inference-introduction"><i class="fa fa-check"></i><b>6.1.2</b> Bayesian Inference: introduction</a></li>
<li class="chapter" data-level="6.1.3" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-flipping-more-coins"><i class="fa fa-check"></i><b>6.1.3</b> Flipping More Coins</a></li>
<li class="chapter" data-level="6.1.4" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-visualization"><i class="fa fa-check"></i><b>6.1.4</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="section-introduction-to-bayesian-inference.html"><a href="section-introduction-to-bayesian-inference.html#section-interactive-app"><i class="fa fa-check"></i><b>6.2</b> Interactive App</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html"><i class="fa fa-check"></i><b>7</b> The Bootstrap</a><ul>
<li class="chapter" data-level="7.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-the-bootstrap-chapter-18"><i class="fa fa-check"></i><b>7.1</b> The Bootstrap (Chapter 18)</a><ul>
<li class="chapter" data-level="7.1.1" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-empirical-bootstrap-old-faithful-data"><i class="fa fa-check"></i><b>7.1.1</b> Empirical bootstrap: Old Faithful data</a></li>
<li class="chapter" data-level="7.1.2" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-parametric-bootstrap-software-data"><i class="fa fa-check"></i><b>7.1.2</b> Parametric Bootstrap: software data</a></li>
<li class="chapter" data-level="7.1.3" data-path="section-the-bootstrap.html"><a href="section-the-bootstrap.html#section-extended-example-the-standard-error-of-a-proportion"><i class="fa fa-check"></i><b>7.1.3</b> Extended example: the standard error of a proportion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a><ul>
<li class="chapter" data-level="8.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-maximum-likelihood-chapter-21"><i class="fa fa-check"></i><b>8.1</b> Maximum Likelihood (Chapter 21)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-two-coins"><i class="fa fa-check"></i><b>8.1.1</b> Example: two coins</a></li>
<li class="chapter" data-level="8.1.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-2"><i class="fa fa-check"></i><b>8.1.2</b> Example: unknown coins, <span class="math inline">\(n = 2\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-example-unknown-coins-n-bigger-than-2"><i class="fa fa-check"></i><b>8.1.3</b> Example: unknown coins, <span class="math inline">\(n\)</span> bigger than <span class="math inline">\(2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="section-maximum-likelihood.html"><a href="section-maximum-likelihood.html#section-extended-example-rental-housing-in-toronto"><i class="fa fa-check"></i><b>8.2</b> Extended example: rental housing in Toronto</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals and Quantifying Uncertainty</a><ul>
<li class="chapter" data-level="9.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-confidence-intervals-for-the-mean-chapter-23"><i class="fa fa-check"></i><b>9.1</b> Confidence Intervals for the Mean (Chapter 23)</a><ul>
<li class="chapter" data-level="9.1.1" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-simulation-an-example"><i class="fa fa-check"></i><b>9.1.1</b> Simulation: an example</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-osterfeld-262de27"><i class="fa fa-check"></i><b>9.1.2</b> Gross calorific value measurements for Osterfeld 262DE27</a></li>
<li class="chapter" data-level="9.1.3" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-when-you-dont-know-sigma"><i class="fa fa-check"></i><b>9.1.3</b> When you don’t know <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="9.1.4" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-gross-calorific-value-measurements-for-daw-mill-258gb41"><i class="fa fa-check"></i><b>9.1.4</b> Gross calorific value measurements for Daw Mill 258GB41</a></li>
<li class="chapter" data-level="9.1.5" data-path="section-confidence-intervals-and-quantifying-uncertainty.html"><a href="section-confidence-intervals-and-quantifying-uncertainty.html#section-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>9.1.5</b> Bootstrap Confidence Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html"><i class="fa fa-check"></i><b>10</b> Extended Example: Reasoning About Goodness of Fit</a><ul>
<li class="chapter" data-level="10.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-go-and-read-the-blog-post"><i class="fa fa-check"></i><b>10.1</b> Go and read the blog post</a></li>
<li class="chapter" data-level="10.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-distribution-of-last-digits"><i class="fa fa-check"></i><b>10.2</b> Distribution of last digits</a><ul>
<li class="chapter" data-level="10.2.1" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-read-in-the-data-1"><i class="fa fa-check"></i><b>10.2.1</b> Read in the data</a></li>
<li class="chapter" data-level="10.2.2" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-make-the-histogram"><i class="fa fa-check"></i><b>10.2.2</b> Make the histogram</a></li>
<li class="chapter" data-level="10.2.3" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-simulation"><i class="fa fa-check"></i><b>10.2.3</b> Testing goodness of fit: simulation</a></li>
<li class="chapter" data-level="10.2.4" data-path="section-extended-example-reasoning-about-goodness-of-fit.html"><a href="section-extended-example-reasoning-about-goodness-of-fit.html#section-testing-goodness-of-fit-math"><i class="fa fa-check"></i><b>10.2.4</b> Testing goodness of fit: math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html"><i class="fa fa-check"></i><b>11</b> Bayesian Inference: Estimation</a><ul>
<li class="chapter" data-level="11.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-general-ideas"><i class="fa fa-check"></i><b>11.1</b> Estimation in Bayesian Inference: general ideas</a><ul>
<li class="chapter" data-level="11.1.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-prior"><i class="fa fa-check"></i><b>11.1.1</b> The Prior</a></li>
<li class="chapter" data-level="11.1.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-the-posterior"><i class="fa fa-check"></i><b>11.1.2</b> The Posterior</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-estimation-in-bayesian-inference-point-and-interval-estimation"><i class="fa fa-check"></i><b>11.2</b> Estimation in Bayesian Inference: point and interval estimation</a></li>
<li class="chapter" data-level="11.3" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-choosing-a-prior"><i class="fa fa-check"></i><b>11.3</b> Choosing a Prior</a><ul>
<li class="chapter" data-level="11.3.1" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-conjugate-priors"><i class="fa fa-check"></i><b>11.3.1</b> Conjugate Priors</a></li>
<li class="chapter" data-level="11.3.2" data-path="section-bayesian-inference-estimation.html"><a href="section-bayesian-inference-estimation.html#section-setting-hyperparameters-by-moment-matching"><i class="fa fa-check"></i><b>11.3.2</b> Setting Hyperparameters by moment-matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html"><i class="fa fa-check"></i><b>12</b> Predictive Modelling</a><ul>
<li class="chapter" data-level="12.1" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-plug-in-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.2</b> Plug-in prediction: coin flipping</a></li>
<li class="chapter" data-level="12.3" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-bayesian-prediction-coin-flipping"><i class="fa fa-check"></i><b>12.3</b> Bayesian Prediction: coin flipping</a></li>
<li class="chapter" data-level="12.4" data-path="section-predictive-modelling.html"><a href="section-predictive-modelling.html#section-extended-example-predicting-call-centre-wait-times"><i class="fa fa-check"></i><b>12.4</b> Extended example: predicting call centre wait times</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>13</b> Installing R and RStudio</a><ul>
<li class="chapter" data-level="13.1" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-r"><i class="fa fa-check"></i><b>13.1</b> Installing R</a></li>
<li class="chapter" data-level="13.2" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-installing-rstudio"><i class="fa fa-check"></i><b>13.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="13.3" data-path="section-installing-r-and-rstudio.html"><a href="section-installing-r-and-rstudio.html#section-using-rmarkdown"><i class="fa fa-check"></i><b>13.3</b> Using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html"><i class="fa fa-check"></i><b>14</b> Assigned Exercises from MIPS</a><ul>
<li class="chapter" data-level="14.1" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-15-and-16"><i class="fa fa-check"></i><b>14.1</b> Chapters 15 and 16</a></li>
<li class="chapter" data-level="14.2" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-13-and-14"><i class="fa fa-check"></i><b>14.2</b> Chapters 13 and 14</a></li>
<li class="chapter" data-level="14.3" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapters-17-and-19"><i class="fa fa-check"></i><b>14.3</b> Chapters 17 and 19</a></li>
<li class="chapter" data-level="14.4" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-20"><i class="fa fa-check"></i><b>14.4</b> Chapter 20</a></li>
<li class="chapter" data-level="14.5" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.1"><i class="fa fa-check"></i><b>14.5</b> Evans and Rosenthal, Chapter 7.1</a></li>
<li class="chapter" data-level="14.6" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-18"><i class="fa fa-check"></i><b>14.6</b> Chapter 18</a></li>
<li class="chapter" data-level="14.7" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-21"><i class="fa fa-check"></i><b>14.7</b> Chapter 21</a></li>
<li class="chapter" data-level="14.8" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-chapter-23"><i class="fa fa-check"></i><b>14.8</b> Chapter 23</a></li>
<li class="chapter" data-level="14.9" data-path="section-assigned-exercises-from-mips.html"><a href="section-assigned-exercises-from-mips.html#section-evans-and-rosenthal-chapter-7.2"><i class="fa fa-check"></i><b>14.9</b> Evans and Rosenthal, Chapter 7.2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html"><i class="fa fa-check"></i><b>15</b> Extended Example: World Population Data</a><ul>
<li class="chapter" data-level="15.1" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-read-in-and-prepare-the-data-for-analysis"><i class="fa fa-check"></i><b>15.1</b> Read in and prepare the data for analysis</a></li>
<li class="chapter" data-level="15.2" data-path="section-extended-example-world-population-data.html"><a href="section-extended-example-world-population-data.html#section-investigate-the-properties-of-the-average-population-of-the-worlds-countries"><i class="fa fa-check"></i><b>15.2</b> Investigate the properties of the average population of the worlds’ countries</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probability, Statistics, and Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-introduction-to-statistics-law-of-large-numbers-and-central-limit-theorem" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Introduction to Statistics: Law of Large Numbers and Central Limit Theorem</h1>
<p>Statistics is the study of <strong>uncertainty</strong> and <strong>variability</strong>. This chapter introduces the two
main physical laws which govern <strong>variability</strong>: the Law of Large Numbers and the Central
Limit Theorem; and describes how these laws are used in the study of <strong>uncertainty</strong>.</p>
<p>This chapter follows chapters 13 and 14 in A Modern Introduction to Probability and Statistics (MIPS).</p>
<div id="section-law-of-large-numbers-chapter-13" class="section level2">
<h2><span class="header-section-number">3.1</span> Law of Large Numbers (Chapter 13)</h2>
<p>The Law of Large Numbers (LLN) states that if you take independent samples from
a well-behaved probability distribution, their sample mean converges in probability to
the true mean. Specifically, if <span class="math inline">\(X_{1},\ldots,X_{n}\overset{iid}{\sim}F\)</span>
and <span class="math inline">\(EX_{1} = \mu\)</span> and <span class="math inline">\(\text{Var}(X_{1}) = \sigma^{2} &lt; \infty\)</span> and <span class="math inline">\(\bar{X}_{n} = (1/n)\sum_{i=1}^{n}X_{i}\)</span> then
<span class="math display">\[
\bar{X}_{n}\overset{p}{\to}\mu
\]</span>
as <span class="math inline">\(n\to\infty\)</span>. We will investigate the LLN computationally through simulations.</p>
<p>Load the packages we need:</p>
<div class="sourceCode" id="section-cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">library</span>(patchwork) <span class="co"># For arranging plots</span></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">2</span>) <span class="co"># Print numbers with only 2 digits</span></a></code></pre></div>
<p>Consider <span class="math inline">\(X_{1},\ldots,X_{n}\overset{iid}{\sim}\text{Gamma}(\alpha,\beta)\)</span>. Their
mean is <span class="math inline">\(EX_{1} = \alpha/\beta\)</span>. If we take a sample from this distribution and
calculate <span class="math inline">\(\bar{X}_{n}\)</span>, we should get something close to <span class="math inline">\(\alpha/\beta\)</span>. If
we make <span class="math inline">\(n\)</span> larger, we should get something closer. The LLN tells us that we can
always make <span class="math inline">\(n\)</span> large enough such that we get as close as we want with as high
a probability as we want.</p>
<p>To simulate from a <span class="math inline">\(\text{Gamma}(\alpha,\beta)\)</span> distribution in , use the
<code>rgamma</code> function:</p>
<div class="sourceCode" id="section-cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># Simulate from a gamma</span></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="co"># Type ?rgamma to get information on the parametrization</span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="co"># There are three named parameters: shape, scale, and rate. Rate = 1/scale.</span></a>
<a class="sourceLine" id="cb115-4" title="4"><span class="co"># The distribution has mean shape * scale, or shape / rate.</span></a>
<a class="sourceLine" id="cb115-5" title="5"><span class="co"># The parametrization in the book is the &quot;rate&quot; parametrization.</span></a>
<a class="sourceLine" id="cb115-6" title="6"><span class="co"># Always read the docs to understand what the parameters are.</span></a>
<a class="sourceLine" id="cb115-7" title="7"><span class="co"># </span></a>
<a class="sourceLine" id="cb115-8" title="8"><span class="co"># Simulate with shape = 2 and rate = 1, so mean = 2 and variance = ? (exercise)</span></a>
<a class="sourceLine" id="cb115-9" title="9"><span class="kw">rgamma</span>(<span class="dv">1</span>,<span class="dt">shape =</span> <span class="dv">2</span>,<span class="dt">rate =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>[1] 1.7</code></pre>
<div class="sourceCode" id="section-cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co"># The first &quot;1&quot; in the call gives the number of values to simulate:</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">rgamma</span>(<span class="dv">10</span>,<span class="dt">shape =</span> <span class="dv">2</span>,<span class="dt">rate =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code> [1] 1.14 3.97 2.55 0.76 2.15 1.25 0.08 1.64 3.78 2.71</code></pre>
<p>We can plot the density of the gamma sample mean for various <span class="math inline">\(n\)</span>. These densities should
have mean <span class="math inline">\(\alpha/\beta = 2/1 = 2\)</span>.</p>
<p><strong>Exercise</strong>: if <span class="math inline">\(X_{1},\ldots,X_{n}\overset{ind}{\sim}\text{Gamma}(\alpha_{i},\beta)\)</span> then for any <span class="math inline">\(b\)</span>,
<span class="math inline">\(b\times \sum_{i=1}^{n}X_{i} \sim \text{Gamma}\left(\sum_{i=1}^{n}\alpha_{i},\beta/b\right)\)</span>. Use
this to derive the distribution of <span class="math inline">\(\bar{X}\)</span> and (hence) explain what the below code is doing.</p>
<p>This is the left
side of Figure 13.1 in MIPS:</p>
<div class="sourceCode" id="section-cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="co"># Define a function to compute the density</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="co"># Fix the scale and shape arguments at defaults of what&#39;s used in the book</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="co"># You can play around with these.</span></a>
<a class="sourceLine" id="cb119-4" title="4">gamma_samplemean_density &lt;-<span class="st"> </span><span class="cf">function</span>(x,n,<span class="dt">shape =</span> <span class="dv">2</span>,<span class="dt">rate =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb119-5" title="5">  <span class="co"># x: point to evaluate the density at</span></a>
<a class="sourceLine" id="cb119-6" title="6">  <span class="co"># n: sample size</span></a>
<a class="sourceLine" id="cb119-7" title="7">  </a>
<a class="sourceLine" id="cb119-8" title="8">  <span class="co"># Just use the dgamma function</span></a>
<a class="sourceLine" id="cb119-9" title="9">  <span class="kw">dgamma</span>(x,<span class="dt">shape =</span> n <span class="op">*</span><span class="st"> </span>shape,<span class="dt">rate =</span> n<span class="op">*</span>rate)</a>
<a class="sourceLine" id="cb119-10" title="10">}</a>
<a class="sourceLine" id="cb119-11" title="11"></a>
<a class="sourceLine" id="cb119-12" title="12"><span class="co"># Plot it for various n</span></a>
<a class="sourceLine" id="cb119-13" title="13"><span class="co"># Define a function to make the plot</span></a>
<a class="sourceLine" id="cb119-14" title="14">plot_for_n &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb119-15" title="15">  <span class="co"># Create a function with the n argument fixed</span></a>
<a class="sourceLine" id="cb119-16" title="16">  densfun &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">partial</span>(gamma_samplemean_density,<span class="dt">n =</span> n)</a>
<a class="sourceLine" id="cb119-17" title="17">  <span class="co"># Plot using ggplot</span></a>
<a class="sourceLine" id="cb119-18" title="18">  <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-19" title="19"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-20" title="20"><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb119-21" title="21"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> densfun) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-22" title="22"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-23" title="23"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> stringr<span class="op">::</span><span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>,n))</a>
<a class="sourceLine" id="cb119-24" title="24">}</a>
<a class="sourceLine" id="cb119-25" title="25"><span class="co"># Create the plots and arrange them</span></a>
<a class="sourceLine" id="cb119-26" title="26"><span class="co"># You need to have the &#39;patchwork&#39; package</span></a>
<a class="sourceLine" id="cb119-27" title="27"><span class="co"># loaded for this to work</span></a>
<a class="sourceLine" id="cb119-28" title="28"><span class="co"># library(patchwork)</span></a>
<a class="sourceLine" id="cb119-29" title="29">(<span class="kw">plot_for_n</span>(<span class="dv">1</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plot_for_n</span>(<span class="dv">2</span>)) <span class="op">/</span></a>
<a class="sourceLine" id="cb119-30" title="30"><span class="st">  </span>(<span class="kw">plot_for_n</span>(<span class="dv">4</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plot_for_n</span>(<span class="dv">9</span>)) <span class="op">/</span></a>
<a class="sourceLine" id="cb119-31" title="31"><span class="st">    </span>(<span class="kw">plot_for_n</span>(<span class="dv">16</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plot_for_n</span>(<span class="dv">400</span>))</a></code></pre></div>
<p><img src="book_files/figure-html/dens-gamma-1-1.png" width="672" /></p>
<p>The density of the sample mean appears centred at <span class="math inline">\(2\)</span> and also appears to concentrate
around <span class="math inline">\(2\)</span>. The LLN says that the sample mean should converge in probability to <span class="math inline">\(2\)</span>
in this example which would correspond to a density which has a point mass at <span class="math inline">\(2\)</span>
and is zero everywhere else. It appears like this might be happening.</p>
<p>We can get a better look at “where the sample mean is going” by doing the following:</p>
<ol style="list-style-type: decimal">
<li><p>Simulate a <span class="math inline">\(\text{Gamma}(2,1)\)</span> sample of size <span class="math inline">\(n\)</span> for some really big <span class="math inline">\(n\)</span>,</p></li>
<li><p>Calculate the the running average of this: for each <span class="math inline">\(m = 1,\ldots,n\)</span>, compute <span class="math inline">\(\bar{X}_{m} = (1/m)\sum_{i=1}^{m}X_{i}\)</span>,</p></li>
<li><p>Plot <span class="math inline">\(\bar{X}_{m}\)</span> against <span class="math inline">\(m\)</span>. <span class="math inline">\(\bar{X}_{m}\)</span> should get closer and closer to <span class="math inline">\(2\)</span> as <span class="math inline">\(m\to n\)</span> (…probably).</p></li>
</ol>
<p>We do this as follows:</p>
<div class="sourceCode" id="section-cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">set.seed</span>(<span class="dv">54768798</span>) <span class="co"># So I can reproduce these results</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="co"># Simulate one experiment of size 500</span></a>
<a class="sourceLine" id="cb120-3" title="3">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb120-4" title="4">alpha &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb120-5" title="5">beta &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb120-6" title="6">gamma_experiment &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dt">n =</span> n,<span class="dt">shape =</span> alpha,<span class="dt">rate =</span> beta)</a>
<a class="sourceLine" id="cb120-7" title="7"></a>
<a class="sourceLine" id="cb120-8" title="8"><span class="co"># Compute the running average- a vector where the nth component is the average</span></a>
<a class="sourceLine" id="cb120-9" title="9"><span class="co"># of the first n terms in gamma_experiment</span></a>
<a class="sourceLine" id="cb120-10" title="10">runningaverage &lt;-<span class="st"> </span><span class="kw">cumsum</span>(gamma_experiment) <span class="op">/</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(gamma_experiment)</a>
<a class="sourceLine" id="cb120-11" title="11"></a>
<a class="sourceLine" id="cb120-12" title="12"><span class="co"># Plot, remembering that the true mean is 2 / 1 = 2</span></a>
<a class="sourceLine" id="cb120-13" title="13"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(runningaverage),</a>
<a class="sourceLine" id="cb120-14" title="14">       <span class="dt">y =</span> runningaverage) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-15" title="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-16" title="16"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb120-17" title="17"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-18" title="18"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> alpha <span class="op">/</span><span class="st"> </span>beta,<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>,<span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/sim-gamma-2-1.png" width="672" /></p>
<p>Is this what you expected to see?</p>
<p><strong>Exercise</strong>: What happens when you increase the number? Try it for <span class="math inline">\(n = 1,000, n = 10,000\)</span>, and so on.</p>
<p>What happens if you break the assumptions of the LLN, that <span class="math inline">\(\text{Var}(X_{1}) &lt; \infty\)</span>?
The Cauchy distribution has some of the worst mathematical properties of any “named”
probability distribution, and so is often used to illustrate what happens when assumptions
of theorems aren’t met. It has <span class="math inline">\(EX^{r} = \infty\)</span> for any <span class="math inline">\(r\geq 1\)</span> so has no finite mean, variance, etc.</p>
<p>Let’s recreate the running average experiment for a random sample <span class="math inline">\(X_{1},\ldots,X_{n}\overset{iid}{\sim}\text{Cauchy}(\mu,\sigma)\)</span>:</p>
<div class="sourceCode" id="section-cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">set.seed</span>(<span class="dv">4235</span>) <span class="co"># So I can reproduce these results</span></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="co"># Simulate one experiment of size 500</span></a>
<a class="sourceLine" id="cb121-3" title="3">n &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb121-4" title="4">mu &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb121-5" title="5">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb121-6" title="6">cauchy_experiment &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dt">n =</span> n,<span class="dt">location =</span> mu,<span class="dt">scale =</span> sigma)</a>
<a class="sourceLine" id="cb121-7" title="7"></a>
<a class="sourceLine" id="cb121-8" title="8"><span class="co"># Compute the running average- a vector where the nth component is the average</span></a>
<a class="sourceLine" id="cb121-9" title="9"><span class="co"># of the first n terms in gamma_experiment</span></a>
<a class="sourceLine" id="cb121-10" title="10">runningaverage &lt;-<span class="st"> </span><span class="kw">cumsum</span>(cauchy_experiment) <span class="op">/</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cauchy_experiment)</a>
<a class="sourceLine" id="cb121-11" title="11"></a>
<a class="sourceLine" id="cb121-12" title="12"><span class="co"># Plot, remembering that the true mean is 2 / 1 = 2</span></a>
<a class="sourceLine" id="cb121-13" title="13"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(runningaverage),</a>
<a class="sourceLine" id="cb121-14" title="14">       <span class="dt">y =</span> runningaverage) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb121-15" title="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x,<span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-16" title="16"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb121-17" title="17"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-18" title="18"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> mu,<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>,<span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/sim-cauchy-1-1.png" width="672" /></p>
<p>Is this what you expected to see? Should you expect to see anything in particular?</p>
<p><strong>Exercise</strong>: repeat this for the Pareto distribution.
You can simulate from the Pareto distribution using the <code>rpareto</code>
function in the <code>actuar</code> package. Type <code>install.packages(&quot;actuar&quot;)</code> and then
<code>actuar::rpareto</code>. Type <code>?actuar::rpareto</code> to get help on using this function.
Figuring out how to use the function is part of the exercise. Read up on the pareto
distribution in MIPS or on Wikipedia or whatever. What do you expect this plot to
show? Reading up on the distribution is also part of the exercise.</p>
<div id="section-extended-example-the-probability-of-heads" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Extended example: the probability of heads</h3>
<p>As an extended example, consider trying to figure out what the probability of
heads is for a fair coin, just based on flipping the coin a bunch of times. We
can use the LLN to address this challenge.</p>
<p>Let <span class="math inline">\(X\)</span> be a random variable which takes values <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> if the coin comes up
tails or heads on any given flip. The specific
event that we are interested in
is whether the coin comes up heads on any given flip. <span class="math inline">\(p = \text{P}(X = 1)\)</span> is
hence the probability of heads and <span class="math inline">\(1-p = \text{P}(X = 0)\)</span> is the probability of
tails. We also have <span class="math inline">\(EX = 0\times (1-p) + 1\times p = p\)</span>. We can hence see what <span class="math inline">\(p\)</span>
must be by flipping the coin a bunch of times, computing the sample proportion of
flips that are heads, and then seeing where this sample proportion appears to be
“going”.</p>
<p>We do this as follows:</p>
<div class="sourceCode" id="section-cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co"># Function to flip the coin n times, and return a sequence of 1 if heads and 0 if tails</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="co"># for each flip.</span></a>
<a class="sourceLine" id="cb122-3" title="3"><span class="co"># Use the rbinom function to simulate from a bernoulli/binomial distribution.</span></a>
<a class="sourceLine" id="cb122-4" title="4">flip_the_coin &lt;-<span class="st"> </span><span class="cf">function</span>(n,p) {</a>
<a class="sourceLine" id="cb122-5" title="5">  <span class="co"># n: number of times to flip the coin.</span></a>
<a class="sourceLine" id="cb122-6" title="6">  <span class="co"># p: probability of heads</span></a>
<a class="sourceLine" id="cb122-7" title="7">  <span class="co"># Returns a vector of length n containing the results of each flip.</span></a>
<a class="sourceLine" id="cb122-8" title="8">  <span class="kw">rbinom</span>(n,<span class="dv">1</span>,p)</a>
<a class="sourceLine" id="cb122-9" title="9">}</a>
<a class="sourceLine" id="cb122-10" title="10"></a>
<a class="sourceLine" id="cb122-11" title="11"><span class="co"># Function to flip the coin n times and compute the</span></a>
<a class="sourceLine" id="cb122-12" title="12"><span class="co"># sample proportion of heads</span></a>
<a class="sourceLine" id="cb122-13" title="13">sample_proportion_of_heads &lt;-<span class="st"> </span><span class="cf">function</span>(n,p) {</a>
<a class="sourceLine" id="cb122-14" title="14">  <span class="co"># Returns a number representing the sample proportion of heads</span></a>
<a class="sourceLine" id="cb122-15" title="15">  <span class="co"># in n flips</span></a>
<a class="sourceLine" id="cb122-16" title="16">  <span class="kw">mean</span>(<span class="kw">flip_the_coin</span>(n,p))</a>
<a class="sourceLine" id="cb122-17" title="17">}</a>
<a class="sourceLine" id="cb122-18" title="18"></a>
<a class="sourceLine" id="cb122-19" title="19"><span class="co"># Try it out:</span></a>
<a class="sourceLine" id="cb122-20" title="20"><span class="kw">sample_proportion_of_heads</span>(<span class="dv">10</span>,.<span class="dv">5</span>)</a></code></pre></div>
<pre><code>[1] 0.4</code></pre>
<div class="sourceCode" id="section-cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">sample_proportion_of_heads</span>(<span class="dv">100</span>,.<span class="dv">5</span>)</a></code></pre></div>
<pre><code>[1] 0.53</code></pre>
<div class="sourceCode" id="section-cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">sample_proportion_of_heads</span>(<span class="dv">1000</span>,.<span class="dv">5</span>)</a></code></pre></div>
<pre><code>[1] 0.47</code></pre>
<p><strong>Exercise</strong>: create a plot of the running average of sample proportions of heads,
similar to the above plots for the Gamma and Cauchy. How many times
do you think you need to flip the coin before the result is an accurate estimate?
Does this change for different values of <span class="math inline">\(p\)</span>?</p>
</div>
</div>
<div id="section-central-limit-theorem-chapter-14" class="section level2">
<h2><span class="header-section-number">3.2</span> Central Limit Theorem (Chapter 14)</h2>
<p>The LLN says where the sample mean goes, and the Central Limit Theorem (CLT) says
how it gets there. The CLT lets us approximate the probability that the sample mean
is any distance we like from the true mean. We will use this later when we are
using the sample mean to estimate the true mean, and want to quantify the uncertainty
in our estimate.</p>
<p>Under the same conditions as the LLN, the CLT says that the
distribution of the standardized sample mean:
<span class="math display">\[
Z_{n} = n^{1/2}\left(\frac{\bar{X} - \mu}{\sigma}\right)
\]</span>
converges to a standard Normal:
<span class="math display">\[
Z_{n}\overset{d}{\to} Z\sim \text{N}(0,1)
\]</span>
as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>The concept of “converging to” is a little bit less intuitive for
a whole distribution compared to just for a single number. It means that for any
set <span class="math inline">\(A\subseteq\mathbb{R}\)</span>, we have <span class="math inline">\(\lim_{n\to\infty}P(Z_{n}\in A) = P(Z\in A)\)</span>.
This is very convenient, because we often don’t know how to use <span class="math inline">\(Z_{n}\)</span> to calculate
probabilities, but <span class="math inline">\(Z\)</span> has a very well-known distribution so it is much easier to
use it to calculate probabilities. We use probabilities calculated from <span class="math inline">\(Z\)</span> to
replace those which we would like to calculate about <span class="math inline">\(Z_{n}\)</span>.</p>
<p>We can
better understand this concept through simulation.</p>
<p>First, let’s investigate the scaling power on <span class="math inline">\(n\)</span> when standardizing averages. In
order for convergence in distribution to occur, the variance of the converging variable
<span class="math inline">\(Z_{n}\)</span> must stabilize, <span class="math inline">\(\text{Var}(Z_{n})\to\text{constant}\)</span>. If you
multiply by the wrong power of <span class="math inline">\(n\)</span>, the variance of <span class="math inline">\(Z_{n}\)</span> will go either to <span class="math inline">\(0\)</span>
or <span class="math inline">\(\infty\)</span> and its distribution will not converge.</p>
<p><strong>Exercise</strong>: derive the probability density of <span class="math inline">\(Y = n^{p}(\bar{X} - \mu)\)</span> when
<span class="math inline">\(X_{1},\ldots,X_{n}\overset{iid}{\sim}\text{Gamma}(2,1)\)</span>. <em>Hint</em>: look at the code
below. How do I compute this? What formula am I using?</p>
<p>Multiplying <span class="math inline">\((\bar{X} - \mu)\)</span> by <span class="math inline">\(n^{1/4}\)</span> isn’t enough to
to stabilize the variance in the distribution, <span class="math inline">\(n^{1}\)</span> is too much, and <span class="math inline">\(n^{1/2}\)</span>
is just right. We can see this as follows:</p>
<div class="sourceCode" id="section-cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">scalingdensity &lt;-<span class="st"> </span><span class="cf">function</span>(y,n,p) {</a>
<a class="sourceLine" id="cb128-2" title="2">  <span class="kw">dgamma</span>(</a>
<a class="sourceLine" id="cb128-3" title="3">    <span class="dt">x =</span> y<span class="op">*</span>n<span class="op">^</span>(<span class="op">-</span>p) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb128-4" title="4">    <span class="dt">shape =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n,</a>
<a class="sourceLine" id="cb128-5" title="5">    <span class="dt">rate =</span> n</a>
<a class="sourceLine" id="cb128-6" title="6">  ) <span class="op">*</span><span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span>p)</a>
<a class="sourceLine" id="cb128-7" title="7">}</a>
<a class="sourceLine" id="cb128-8" title="8"></a>
<a class="sourceLine" id="cb128-9" title="9">plotscalingdensity &lt;-<span class="st"> </span><span class="cf">function</span>(n,p) {</a>
<a class="sourceLine" id="cb128-10" title="10">  dens &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">partial</span>(scalingdensity,<span class="dt">n =</span> n,<span class="dt">p =</span> p)</a>
<a class="sourceLine" id="cb128-11" title="11">  <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb128-12" title="12"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-13" title="13"><span class="st">    </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb128-14" title="14"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dens) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-15" title="15"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-16" title="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> stringr<span class="op">::</span><span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>,n,<span class="st">&quot;; scaling = &quot;</span>,p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-17" title="17"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>))</a>
<a class="sourceLine" id="cb128-18" title="18">}</a>
<a class="sourceLine" id="cb128-19" title="19"></a>
<a class="sourceLine" id="cb128-20" title="20"><span class="co"># Plot them all and arrange</span></a>
<a class="sourceLine" id="cb128-21" title="21"></a>
<a class="sourceLine" id="cb128-22" title="22">( <span class="kw">plotscalingdensity</span>(<span class="dv">1</span>,.<span class="dv">25</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">1</span>,.<span class="dv">5</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">1</span>,<span class="dv">1</span>) ) <span class="op">/</span></a>
<a class="sourceLine" id="cb128-23" title="23"><span class="st">  </span>( <span class="kw">plotscalingdensity</span>(<span class="dv">2</span>,.<span class="dv">25</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">2</span>,.<span class="dv">5</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">2</span>,<span class="dv">1</span>) ) <span class="op">/</span></a>
<a class="sourceLine" id="cb128-24" title="24"><span class="st">  </span>( <span class="kw">plotscalingdensity</span>(<span class="dv">4</span>,.<span class="dv">25</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">4</span>,.<span class="dv">5</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">4</span>,<span class="dv">1</span>) ) <span class="op">/</span></a>
<a class="sourceLine" id="cb128-25" title="25"><span class="st">  </span>( <span class="kw">plotscalingdensity</span>(<span class="dv">16</span>,.<span class="dv">25</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">16</span>,.<span class="dv">5</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">16</span>,<span class="dv">1</span>) ) <span class="op">/</span></a>
<a class="sourceLine" id="cb128-26" title="26"><span class="st">  </span>( <span class="kw">plotscalingdensity</span>(<span class="dv">100</span>,.<span class="dv">25</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">100</span>,.<span class="dv">5</span>) <span class="op">|</span><span class="st"> </span><span class="kw">plotscalingdensity</span>(<span class="dv">100</span>,<span class="dv">1</span>) )</a></code></pre></div>
<p><img src="book_files/figure-html/scaling-1-1.png" width="672" /></p>
<p>On the left the scaling is too little, and the distribution will become infinitely
peaked (zero variance) as <span class="math inline">\(n\)</span> gets bigger (try it!). This distribution is not
useful for calculating probabilities.</p>
<p>On the right the scaling is too much and the distribution becomes flat (infinite
variance). This distribution is not useful for calculating probabilities.</p>
<p>In the middle, we have scaled by a good amount. The distribution appears to become
closer and closer to a standard Normal distribution as <span class="math inline">\(n\)</span> gets bigger. This
distribution is useful for calculating probabilities.</p>
<p>You can play around with different scaling values and sample sizes.</p>
<p>Figure 14.2 is like the centre column of Figure 14.1 with a normal density
curve overlayed.</p>
<p><strong>Exercise</strong>: recreate the left column of Figure 14.2 by doing the following:</p>
<ol style="list-style-type: decimal">
<li>Replace <code>expand.grid(n = c(1,2,4,16,100),p = c(1/4,1/2,1))</code> by
<code>expand.grid(n = c(1,2,4,16,100),p = c(1/2))</code> in the above code that generates
the plots (and set the values of <code>nrow</code> and <code>ncol</code> appropriately as well).</li>
<li>Add a normal density line. You have to modify the <code>plotscalingdensity</code>. Add
a layer as follows: <code>stat_function(fun = dnorm,linetype = &quot;dotted&quot;)</code>.</li>
</ol>
<p>We can compute probabilities involving the standard normal distribution function
in <code>R</code> using the <code>pnorm</code> function. Suppose we compute the sample mean from a <span class="math inline">\(\text{Gamma}(2,1)\)</span>
random sample:</p>
<div class="sourceCode" id="section-cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">set.seed</span>(<span class="dv">8257899</span>)</a>
<a class="sourceLine" id="cb129-2" title="2">n &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb129-3" title="3">gammamean &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rgamma</span>(n,<span class="dv">2</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb129-4" title="4">gammamean</a></code></pre></div>
<pre><code>[1] 2</code></pre>
<p>We know the true mean is <span class="math inline">\(2\)</span>. How “close” is 2.05 to <span class="math inline">\(2\)</span>? We can quantify
this by asking: how probable is it to get a sample mean of 2.05 or greater in a sample
of size 500 from a <span class="math inline">\(\text{Gamma}(2,1)\)</span> distribution?</p>
<div class="sourceCode" id="section-cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># The actual probability is (why? remember a previous exercise...):</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pgamma</span>(gammamean,<span class="dt">shape =</span> <span class="dv">2</span><span class="op">*</span>n,<span class="dt">rate =</span> <span class="dv">1</span><span class="op">*</span>n)</a></code></pre></div>
<pre><code>[1] 0.22</code></pre>
<div class="sourceCode" id="section-cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="co"># The CLT probability is as follows:</span></a>
<a class="sourceLine" id="cb133-2" title="2">Zn &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n) <span class="op">*</span><span class="st"> </span>(gammamean <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb133-3" title="3"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(Zn)</a></code></pre></div>
<pre><code>[1] 0.22</code></pre>
<div class="sourceCode" id="section-cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="co"># Why are we doing 1 - pnorm()? pnorm() gives P(X &lt; x) for X ~ N(0,1)</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="co"># To get P(X &gt; x), you can do</span></a>
<a class="sourceLine" id="cb135-3" title="3"><span class="kw">pnorm</span>(Zn,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>[1] 0.22</code></pre>
<div class="sourceCode" id="section-cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="co"># but it&#39;s easier to just do P(X &gt; x) = 1 - P(X &lt; x)</span></a></code></pre></div>
<p>Pretty close approximation!</p>
<p>We could also approximate this probability by generating a bunch of gamma random
samples and seeing how often their averages are &gt; 2.05:</p>
<div class="sourceCode" id="section-cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">N &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb138-2" title="2">exceeded &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb138-4" title="4">  samp &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n,<span class="dt">shape =</span> <span class="dv">2</span>,<span class="dt">rate =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb138-5" title="5">  mn &lt;-<span class="st"> </span><span class="kw">mean</span>(samp)</a>
<a class="sourceLine" id="cb138-6" title="6">  exceeded[i] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(mn <span class="op">&gt;</span><span class="st"> </span>gammamean)</a>
<a class="sourceLine" id="cb138-7" title="7">}</a>
<a class="sourceLine" id="cb138-8" title="8"><span class="kw">mean</span>(exceeded)</a></code></pre></div>
<pre><code>[1] 0.22</code></pre>
<p><strong>Exercise</strong>: why does this simulation give us an idea of <span class="math inline">\(P(\bar{X} &gt; 2.05)\)</span>?
Hint: recall the coin flipping example: consider <span class="math inline">\(\bar{X} &gt; 2.05\)</span> to be like
a coin coming up heads and estimate this probability using the method we came up with
in that example.</p>
<div id="section-extended-example-the-probability-of-heads-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Extended example: the probability of heads</h3>
<p>In our coin example from the LLN section, we investigated how many flips
were needed to get an average number of heads that was close (in probability) to the true
probability of heads. Using the CLT, we can get a <em>probabilistic quantification</em>
of the error rate– how far away from the truth the proportion of heads is likely to be.</p>
<p>Similar to the LLN experiment, we’re goin to flip the coin a bunch of times and
calculate the sample proportion of heads; then we’re going to do <em>that</em> a bunch
of times and plot a histogram of the sample proportions. The CLT tells us that
as long as each experiment has enough flips, the resulting probability density
of the sample proportion of heads should be approximately Normal.</p>
<div class="sourceCode" id="section-cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">N &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of experiments to do</span></a>
<a class="sourceLine" id="cb140-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># Number of times to flip the coin in each experiment</span></a>
<a class="sourceLine" id="cb140-3" title="3">p &lt;-<span class="st"> </span><span class="fl">.5</span> <span class="co"># True probability of heads</span></a>
<a class="sourceLine" id="cb140-4" title="4">experiments &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb140-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb140-6" title="6">  experiments[i] &lt;-<span class="st"> </span><span class="kw">sample_proportion_of_heads</span>(n,p)</a>
<a class="sourceLine" id="cb140-7" title="7">}</a>
<a class="sourceLine" id="cb140-8" title="8"></a>
<a class="sourceLine" id="cb140-9" title="9"><span class="co"># Plot them</span></a>
<a class="sourceLine" id="cb140-10" title="10"><span class="kw">tibble</span>(<span class="dt">x =</span> experiments) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb140-11" title="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-12" title="12"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb140-13" title="13"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..),<span class="dt">bins=</span><span class="dv">30</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-14" title="14"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,<span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> p,<span class="dt">sd =</span> <span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>n)),<span class="dt">colour =</span> <span class="st">&quot;purple&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-15" title="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Empirical distribution of sample proportions of heads&quot;</span>,</a>
<a class="sourceLine" id="cb140-16" title="16">       <span class="dt">subtitle =</span> stringr<span class="op">::</span><span class="kw">str_c</span>(<span class="st">&quot;# of flips: &quot;</span>,n,<span class="st">&quot;, true probability of heads: &quot;</span>,p),</a>
<a class="sourceLine" id="cb140-17" title="17">       <span class="dt">x =</span> <span class="st">&quot;Proportion of heads&quot;</span>,</a>
<a class="sourceLine" id="cb140-18" title="18">       <span class="dt">y =</span> <span class="st">&quot;Empirical Density&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb140-19" title="19"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">by=</span>.<span class="dv">1</span>))</a></code></pre></div>
<p><img src="book_files/figure-html/clt-1-1.png" width="672" /></p>
<p><strong>Exercises</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Recreate the above plot with <span class="math inline">\(n = 10, 50, 100, 1000\)</span> and <span class="math inline">\(p = .4, .2, .8, .01, .99\)</span>.
What do you see? Is the accuracy of the normal approximation to this distribution
affected by <span class="math inline">\(n\)</span> or <span class="math inline">\(p\)</span>?</p></li>
<li><p>What are the mean and variance of the distribution of sample proportions of heads?
(Hint: what are the mean and variance of a <span class="math inline">\(\text{Binom}(n,p)\)</span> random variable?)</p></li>
<li><p>Recreate the above plot, but scale the sample proportion of heads appropriately such
that it has mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(1\)</span>.</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-introduction-to-data-analysis-data-input-and-basic-summaries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-statistical-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
